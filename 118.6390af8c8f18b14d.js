"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[118],{2008:(y,h,n)=>{n.d(h,{l:()=>E});var a=n(6895),m=n(4466),r=n(666),f=n(8274);let E=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=f.oAB({type:t}),t.\u0275inj=f.cJS({imports:[a.ez,m.m,r.kW]}),t})()},3948:(y,h,n)=>{n.d(h,{h:()=>t});var a=n(8274),m=n(6895),r=n(6679);const f=function(p){return{background:p}};function E(p,o){if(1&p&&(a.ynx(0),a.TgZ(1,"p-tag",1)(2,"div",2),a._UZ(3,"i",3),a.TgZ(4,"span",4),a._uU(5),a.qZA()()(),a.BQk()),2&p){const d=o.ngIf;a.xp6(1),a.Akn(a.VKq(6,f,d.color)),a.Q6J("rounded",!0),a.xp6(2),a.Tol(d.icon),a.xp6(2),a.Oqu(d.name)}}let t=(()=>{class p{constructor(){}ngOnInit(){}trackByFn(d,u){return u.id||d}}return p.\u0275fac=function(d){return new(d||p)},p.\u0275cmp=a.Xpm({type:p,selectors:[["app-task-status"]],inputs:{taskStatus:"taskStatus"},decls:1,vars:1,consts:[[4,"ngIf"],["styleClass","px-3",3,"rounded"],[1,"flex","align-items-center","gap-1"],[2,"font-size","11px"],[1,"font-semibold",2,"font-size","11px"]],template:function(d,u){1&d&&a.YNc(0,E,6,8,"ng-container",0),2&d&&a.Q6J("ngIf",u.taskStatus)},dependencies:[m.O5,r.V],encapsulation:2}),p})()},9981:(y,h,n)=>{n.d(h,{o:()=>f});var a=n(6895),m=n(6679),r=n(8274);let f=(()=>{class E{}return E.\u0275fac=function(p){return new(p||E)},E.\u0275mod=r.oAB({type:E}),E.\u0275inj=r.cJS({imports:[a.ez,m.W]}),E})()},3446:(y,h,n)=>{n.d(h,{O:()=>p});var a=n(8274),m=n(433),r=n(6895),f=n(2156),E=n(585);function t(o,d){1&o&&(a.ynx(0),a.TgZ(1,"label",3)(2,"span"),a._uU(3,"\u0e9b\u0eb0\u0e88\u0eb3\u0e9b\u0eb5:"),a.qZA()(),a.BQk())}let p=(()=>{class o{constructor(u,c){this.parentForm=u,this.cdr=c,this.showLabel=!0,this.yearSelected=new a.vpe,this.onChange=()=>{},this.onTouched=()=>{}}get control(){return this.formGroup.get("docYear")}ngOnInit(){this.formGroup=this.parentForm.control;const u=(new Date).getFullYear(),c=new Date(u,0,1);this.formGroup.patchValue({docYear:c}),this.cdr.detectChanges()}writeValue(u){u&&(this.selectedValue=u)}registerOnChange(u){this.onChange=u}registerOnTouched(u){this.onTouched=u}onSelectYear(u){this.writeValue(u),this.onChange(u),this.yearSelected.emit(u)}}return o.\u0275fac=function(u){return new(u||o)(a.Y36(m.sg),a.Y36(a.sBO))},o.\u0275cmp=a.Xpm({type:o,selectors:[["app-year-picker"]],inputs:{showLabel:"showLabel"},outputs:{yearSelected:"yearSelected"},features:[a._Bn([{provide:m.JU,useExisting:(0,a.Gpc)(()=>o),multi:!0}])],decls:3,vars:3,consts:[[3,"formGroup"],[4,"ngIf"],["view","year","dateFormat","yy","inputId","yearpicker","placeholder","\u0ec0\u0ea5\u0eb7\u0ead\u0e81\u0e9b\u0eb5","styleClass","mr-2","formControlName","docYear",3,"readonlyInput","onSelect"],["for","yearpicker",1,"font-semibold","white-space-nowrap","mr-1"]],template:function(u,c){1&u&&(a.TgZ(0,"form",0),a.YNc(1,t,4,0,"ng-container",1),a.TgZ(2,"p-calendar",2),a.NdJ("onSelect",function(v){return c.onSelectYear(v)}),a.qZA()()),2&u&&(a.Q6J("formGroup",c.formGroup),a.xp6(1),a.Q6J("ngIf",c.showLabel),a.xp6(1),a.Q6J("readonlyInput",!0))},dependencies:[r.O5,m._Y,m.JJ,m.JL,m.sg,m.u,f.bc,f.VP,f.YE,E.f],encapsulation:2}),o})()},6522:(y,h,n)=>{n.d(h,{_:()=>a});class a{static getWaiting(r,f=!0){let E=["main.id","main.docYear","main.taskId","main.taskSubject","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.selfCode","main.createdAt","main.isLock","staff.staffCode","staff.firstName","staff.lastName","status.icon","status.name","status.color"];return f&&E.push("main.taskWfId"),{query:{fields:E,joins:["staff","status"],filters:r,getType:"MANY"}}}static getMany(r){return{query:{fields:["main.docYear","main.id","main.taskId","main.taskSubject","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.headTimeScore","main.headQuantityScore","main.headQualityScore","main.headSatisfiedScore","main.selfCode","main.createdAt","main.headActionAt","main.isLock","staff.staffCode","staff.firstName","staff.lastName","status.icon","status.name","status.color"],joins:["staff","status"],filters:r,getType:"MANY"}}}static getDetail(r,f=!0){const E=["main.docYear","main.id","main.taskId","main.taskSubject","main.reportDetail","main.scheduledStart","main.scheduledEnd","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.selfCode","main.headTimeScore","main.headQuantityScore","main.headQualityScore","main.headSatisfiedScore","main.createdAt","main.headActionAt","main.comment","task.indicatorTime","task.indicatorQuantity","iq.id","iq.subject","is.id","is.subject","priority.name","priority.color","priority.score","staff.staffCode","staff.firstName","staff.lastName","head.staffCode","head.firstName","head.lastName","status.icon","status.name","status.color","attached.fileName","attached.filePath"];return f&&E.push("main.taskWfId"),{query:{fields:E,joins:["task","iq","is","priority","staff","head","status","attached"],filters:r,getType:"ONE"}}}static getPlanSubDetail(r){return{query:{fields:["main.id","main.docYear","main.taskWfId","main.taskId","main.taskSubject","main.reportDetail","main.scheduledStart","main.scheduledEnd","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.selfCode","main.headTimeScore","main.headQuantityScore","main.headQualityScore","main.headSatisfiedScore","main.createdAt","main.headActionAt","main.comment","task.indicatorTime","task.indicatorQuantity","iq.id","iq.subject","is.id","is.subject","staff.staffCode","staff.firstName","staff.lastName","head.staffCode","head.firstName","head.lastName","status.icon","status.name","status.color","attached.fileName","attached.filePath"],joins:["task","iq","is","staff","head","status","attached"],filters:r,getType:"ONE"}}}}},875:(y,h,n)=>{n.d(h,{K:()=>a});class a{static getMany(r){return{query:{fields:["main.id","main.docYear","main.taskId","main.taskSubject","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.selfCode","main.createdAt","main.isLock","status.id","status.icon","status.name","status.color"],joins:["status"],filters:r,getType:"MANY"}}}static getDetail(r){return{query:{fields:["main.id","main.docYear","main.taskId","main.taskSubject","main.reportDetail","main.scheduledStart","main.scheduledEnd","main.selfTimeScore","main.selfQuantityScore","main.selfQualityScore","main.selfSatisfiedScore","main.selfCode","main.createdAt","main.headActionAt","main.comment","task.id","task.indicatorTime","task.indicatorQuantity","iq.id","iq.subject","is.id","is.subject","staff.staffCode","staff.firstName","staff.lastName","head.staffCode","head.firstName","head.lastName","status.icon","status.name","status.color","attached.attachRefId","attached.docRefId","attached.fileName","attached.filePath"],joins:["task","iq","is","staff","head","status","attached"],filters:r,getType:"ONE"}}}static getStatus(r){return{query:{fields:["main.id","status.id","status.name","status.icon","status.color"],joins:["status"],filters:r,getType:"ONE"}}}}},5573:(y,h,n)=>{n.r(h),n.d(h,{ReportHistoryModule:()=>Dt});var a=n(6895),m=n(5675),r=n(7579),f=n(2722),E=n(7248),t=n(8274),p=n(8145),o=n(4325),d=n(6832),u=n(1094),c=n(2156),g=n(1481),v=n(9166),Z=n(9869),T=n(433),C=n(793),D=n(805),U=n(3608),R=n(1740),M=n(3948),b=n(3446),O=n(875),Y=n(704),P=n(8639),w=n(2946),H=n(7147),Q=n(3609);function k(i,l){1&i&&(t.TgZ(0,"span",7),t._uU(1,"\u0e81\u0eb2\u0e99\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e82\u0ead\u0e87 (\u0e95\u0ebb\u0e99\u0ec0\u0ead\u0e87)"),t.qZA())}function N(i,l){if(1&i&&t._UZ(0,"div",16),2&i){const e=t.oxw().ngIf,s=t.oxw();t.Q6J("innerHTML",s.transform(null==e?null:e.reportDetail),t.oJD)}}function L(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td",17)(2,"span",18),t._uU(3,"\u0e94\u0ec9\u0eb2\u0e99\u0ec0\u0ea7\u0ea5\u0eb2:"),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"td",19),t._UZ(8,"p-badge",20),t.qZA()()),2&i){const e=t.oxw().ngIf,s=t.oxw().ngIf;t.xp6(5),t.Oqu(t.xi3(6,2,null==e?null:e.indicatorTime,"dd/MM/yyyy HH:mm")),t.xp6(3),t.s9C("value",null==s?null:s.selfTimeScore)}}function j(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td",17)(2,"span",18),t._uU(3,"\u0e94\u0ec9\u0eb2\u0e99\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99:"),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",19),t._UZ(7,"p-badge",20),t.qZA()()),2&i){const e=t.oxw().ngIf,s=t.oxw().ngIf;t.xp6(5),t.hij(" ",null==e?null:e.indicatorQuantity,""),t.xp6(2),t.s9C("value",null==s?null:s.selfQuantityScore)}}function F(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td",17)(2,"span",18),t._uU(3,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a:"),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",19),t._UZ(7,"p-badge",20),t.qZA()()),2&i){const e=t.oxw().ngIf,s=t.oxw().ngIf;t.xp6(5),t.Oqu(null==e||null==e.indicatorQuality?null:e.indicatorQuality.subject),t.xp6(2),t.s9C("value",null==s?null:s.selfQualityScore)}}function J(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td",17)(2,"span",18),t._uU(3,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88:"),t.qZA()(),t.TgZ(4,"td"),t._uU(5),t.qZA(),t.TgZ(6,"td",19),t._UZ(7,"p-badge",20),t.qZA()()),2&i){const e=t.oxw().ngIf,s=t.oxw().ngIf;t.xp6(5),t.Oqu(null==e||null==e.indicatorSatisfied?null:e.indicatorSatisfied.subject),t.xp6(2),t.s9C("value",null==s?null:s.selfSatisfiedScore)}}function z(i,l){if(1&i&&(t.ynx(0),t.YNc(1,L,9,5,"tr",0),t.YNc(2,j,8,2,"tr",0),t.YNc(3,F,8,2,"tr",0),t.YNc(4,J,8,2,"tr",0),t.BQk()),2&i){const e=l.ngIf;t.xp6(1),t.Q6J("ngIf",null==e?null:e.indicatorTime),t.xp6(1),t.Q6J("ngIf",null==e?null:e.indicatorQuantity),t.xp6(1),t.Q6J("ngIf",null==e?null:e.indicatorQuality),t.xp6(1),t.Q6J("ngIf",null==e?null:e.indicatorSatisfied)}}function W(i,l){if(1&i){const e=t.EpF();t.TgZ(0,"p-chip",24),t.NdJ("click",function(){const A=t.CHM(e).$implicit,B=t.oxw(3);return t.KtG(B.showPreviewFromUrl(null==A?null:A.filePath))}),t._UZ(1,"i",25),t.TgZ(2,"span",26),t._uU(3),t.qZA()()}if(2&i){const e=l.$implicit;t.xp6(3),t.hij("",null==e?null:e.fileName," ")}}function q(i,l){if(1&i&&(t.ynx(0),t.TgZ(1,"div",8)(2,"label",5),t._uU(3,"\u0ec0\u0ead\u0e81\u0eb0\u0eaa\u0eb2\u0e99\u0ec1\u0e99\u0e9a"),t.qZA(),t._UZ(4,"hr",21),t.TgZ(5,"div",22),t.YNc(6,W,4,1,"ng-template",23),t.qZA()(),t.BQk()),2&i){const e=t.oxw().ngIf;t.xp6(6),t.Q6J("ngForOf",e.attachments)}}function K(i,l){1&i&&(t.TgZ(0,"span",7),t._uU(1,"\u0e81\u0eb2\u0e99\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0e82\u0ead\u0e87 (\u0eab\u0ebb\u0ea7\u0edc\u0ec9\u0eb2)"),t.qZA())}function $(i,l){if(1&i&&(t.TgZ(0,"p-fieldset",27),t.YNc(1,K,2,0,"ng-template",2),t.TgZ(2,"div",3)(3,"div",6)(4,"div")(5,"label",7),t._uU(6,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99:"),t.qZA()(),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"div",13)(10,"div")(11,"label",7),t._uU(12,"\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0ec2\u0e94\u0e8d:"),t.qZA()(),t._uU(13),t.qZA(),t.TgZ(14,"div",8)(15,"div")(16,"label",7),t._uU(17,"\u0e84\u0eb3\u0ec0\u0eab\u0eb1\u0e99"),t.qZA()(),t._uU(18),t.qZA()()()),2&i){const e=t.oxw().ngIf;t.Q6J("toggleable",!0),t.xp6(7),t.hij(" ",t.xi3(8,5,null==e?null:e.headActionAt,"dd/MM/yyyy HH:mm")," "),t.xp6(6),t.AsE(" ",null==e||null==e.head?null:e.head.firstName," ",null==e||null==e.head?null:e.head.lastName," "),t.xp6(5),t.hij(" ",null==e?null:e.comment," ")}}function G(i,l){if(1&i&&(t.ynx(0),t.TgZ(1,"p-fieldset",1),t.YNc(2,k,2,0,"ng-template",2),t.TgZ(3,"div",3)(4,"div",4)(5,"label",5),t._uU(6),t.qZA()(),t.TgZ(7,"div",6)(8,"div")(9,"label",7),t._uU(10,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99:"),t.qZA()(),t._uU(11),t.ALo(12,"date"),t.qZA(),t.TgZ(13,"div",8)(14,"label",5),t._uU(15,"\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99\u0ec2\u0e94\u0e8d:"),t.qZA(),t._uU(16),t.qZA(),t.TgZ(17,"div",8)(18,"label",5),t._uU(19,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81"),t.qZA(),t.TgZ(20,"div"),t._uU(21),t.qZA()(),t.TgZ(22,"div",8)(23,"label",5),t._uU(24,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0e84\u0ea7\u0eb2\u0ea1\u0e84\u0eb7\u0e9a\u0edc\u0ec9\u0eb2"),t.qZA(),t.YNc(25,N,1,1,"div",9),t.qZA(),t.TgZ(26,"div",4)(27,"label",5),t._uU(28,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0ec0\u0ea5\u0eb5\u0ec8\u0ea1\u0e9b\u0eb0\u0e95\u0eb4\u0e9a\u0eb1\u0e94:"),t.qZA(),t._uU(29),t.ALo(30,"date"),t.qZA(),t.TgZ(31,"div",8)(32,"label",5),t._uU(33,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0eaa\u0eb3\u0ec0\u0ea5\u0eb1\u0e94:"),t.qZA(),t._uU(34),t.ALo(35,"date"),t.qZA(),t.TgZ(36,"div",8)(37,"table",10)(38,"thead")(39,"tr")(40,"th",11),t._uU(41,"\u0e81\u0eb2\u0e99\u0e95\u0eb1\u0ec9\u0e87\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA(),t.TgZ(42,"th",12),t._uU(43,"\u0e81\u0eb2\u0e99\u0ec3\u0eab\u0ec9\u0e84\u0eb0\u0ec1\u0e99\u0e99"),t.qZA()()(),t.TgZ(44,"tbody"),t.YNc(45,z,5,4,"ng-container",0),t.qZA()()(),t.TgZ(46,"div",13)(47,"label",5),t._uU(48,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0:"),t.qZA(),t._UZ(49,"app-task-status",14),t.qZA(),t.YNc(50,q,7,1,"ng-container",0),t.qZA()(),t.YNc(51,$,19,8,"p-fieldset",15),t.BQk()),2&i){const e=l.ngIf;t.xp6(1),t.Q6J("toggleable",!0),t.xp6(5),t.hij("\u0e9b\u0eb0\u0e88\u0eb3\u0e9b\u0eb5: ",null==e?null:e.docYear,""),t.xp6(5),t.hij(" ",t.xi3(12,13,null==e?null:e.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(5),t.AsE(" ",null==e||null==e.staff?null:e.staff.firstName," ",null==e||null==e.staff?null:e.staff.lastName," "),t.xp6(5),t.Oqu(null==e?null:e.taskSubject),t.xp6(4),t.Q6J("ngIf",null==e?null:e.reportDetail),t.xp6(4),t.hij(" ",t.xi3(30,16,null==e?null:e.scheduledStart,"dd/MM/yyyy")," "),t.xp6(5),t.hij(" ",t.xi3(35,19,null==e?null:e.scheduledEnd,"dd/MM/yyyy HH:mm")," "),t.xp6(11),t.Q6J("ngIf",null==e?null:e.task),t.xp6(4),t.Q6J("taskStatus",null==e?null:e.status),t.xp6(1),t.Q6J("ngIf",e.attachments&&e.attachments.length),t.xp6(1),t.Q6J("ngIf",null==e?null:e.headActionAt)}}function V(i,l){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-file-preview",28),t.NdJ("closePreview",function(){t.CHM(e);const _=t.oxw();return t.KtG(_.closeImgPreview())}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw();t.xp6(1),t.Q6J("selectedFileOrUrl",e.fileSrc)}}let X=(()=>{class i{constructor(e,s,_,A,B,S){this.selfEvalService=e,this.dialogConfig=s,this.dialogRef=_,this.sanitizer=A,this.utilService=B,this.alertService=S,this.visiblePreview=!1,this.destroy$=new r.x}ngOnInit(){this.docId=this.dialogConfig?.data?.docId,this.getReportDetail()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}closeImgPreview(){this.visiblePreview=!1}showPreviewFromUrl(e){e&&(this.utilService.isValidUrl(e)?(this.fileSrc=e,this.visiblePreview=!0):this.alertService.showDanger("\u0eae\u0eb9\u0e9a\u0ec1\u0e9a\u0e9a\u0e97\u0eb5\u0ec8\u0ea2\u0eb9\u0ec8\u0e82\u0ead\u0e87\u0ec4\u0e9f\u0ea5\u0ecc\u0e9a\u0ecd\u0ec8\u0e96\u0eb7\u0e81\u0e95\u0ec9\u0ead\u0e87!"))}getReportDetail(){if(!this.docId)return;const s=O.K.getDetail({id:this.docId});this.selfEvalService.getOne(s).subscribe(),this.evaluation$=this.selfEvalService.item$}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(v.A),t.Y36(o.S),t.Y36(o.E7),t.Y36(g.H7),t.Y36(u.F),t.Y36(Y.c))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-report-detail"]],decls:3,vars:4,consts:[[4,"ngIf"],[3,"toggleable"],["pTemplate","header"],[1,"formgrid","grid","p-fluid"],[1,"col-12"],[1,"font-semibold","text-xl","mb-0"],[1,"col-12","flex","align-items-center","gap-2"],[1,"font-semibold","text-xl"],[1,"field","col-12"],[3,"innerHTML",4,"ngIf"],[1,"table-custom","my-4"],["colspan","2",1,"text-left","text-lg","white-space-nowrap"],[1,"text-center","text-lg","white-space-nowrap"],[1,"field","col-12","flex","align-items-center","gap-2"],[3,"taskStatus"],["styleClass","mt-5",3,"toggleable",4,"ngIf"],[3,"innerHTML"],[1,"white-space-nowrap"],[1,"font-bold"],[1,"text-center"],[3,"value"],[1,"mt-0"],[1,"flex","gap-2"],["ngFor","",3,"ngForOf"],["styleClass","cursor-pointer",3,"click"],[1,"pi","pi-paperclip","mr-2","text-green-500"],[1,"w-8rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],["styleClass","mt-5",3,"toggleable"],[3,"selectedFileOrUrl","closePreview"]],template:function(e,s){1&e&&(t.YNc(0,G,52,22,"ng-container",0),t.ALo(1,"async"),t.YNc(2,V,2,1,"ng-container",0)),2&e&&(t.Q6J("ngIf",t.lcZ(1,2,s.evaluation$)),t.xp6(2),t.Q6J("ngIf",s.visiblePreview))},dependencies:[a.sg,a.O5,D.jx,P.Ct,w.p,H.A,Q.Q,M.h,a.Ov,a.uU],encapsulation:2}),i})();var x=n(4090),tt=n(209),I=n(605);let et=(()=>{class i{constructor(e,s,_,A,B){this.dialogRef=e,this.dialogService=s,this.confirmService=_,this.selfEvalService=A,this.alertService=B,this.isLock=!1,this.menuItems=[]}ngOnInit(){this.evalId=this.task?.id,this.taskStatusId=this.task?.status?.id??-1,this.isLock=this.task?.isLock??!1}setActionMenus(){this.menuItems=this.isLock||[x.hY.EVALUATED,x.hY.CANCELED,x.hY.REJECTED].includes(this.taskStatusId)?[]:[{label:"\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81",icon:"pi pi-times",command:()=>{this.task?.id&&this.onCancle()}}]}showDetail(){this.task&&(this.dialogRef=this.dialogService.open(X,{header:`\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0e81\u0eb2\u0e99\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99 #${this.task?.id}`,width:window.innerWidth>tt.A.lg?"65%":"80%",data:{docId:this.task?.id},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,maximizable:!0}))}onCancle(){this.evalId&&this.confirmService.confirm({message:"\u0ec1\u0e99\u0ec8\u0ec3\u0e88\u0e9a\u0ecd\u0ec8\u0ea7\u0ec8\u0eb2\u0e95\u0ec9\u0ead\u0e87\u0e81\u0eb2\u0e99\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81\u0e81\u0eb2\u0e99\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99\u0e99\u0eb5\u0ec9?",icon:"pi pi-exclamation-triangle",accept:()=>{this.selfEvalService.update(this.evalId,{statusId:x.hY.CANCELED,isActive:!1}).subscribe({next:s=>{s&&(this.getWfStatus(),this.alertService.showSuccess("\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81\u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99\u0ec1\u0ea5\u0ec9\u0ea7"))},error:s=>this.alertService.showError(s)})}})}getWfStatus(){if(this.evalId){const e=Object.assign({id:this.evalId}),s=O.K.getStatus(e);this.selfEvalService.getOneAndReplace(s).subscribe()}}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(o.E7),t.Y36(o.xA),t.Y36(D.YP),t.Y36(v.A),t.Y36(Y.c))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-btn-action"]],inputs:{task:"task"},decls:1,vars:1,consts:[["appendTo","body","label","\u0ec0\u0e9a\u0eb4\u0ec8\u0e87\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94","styleClass","p-button-secondary p-button-sm",3,"model","onClick","onDropdownClick"]],template:function(e,s){1&e&&(t.TgZ(0,"p-splitButton",0),t.NdJ("onClick",function(){return s.showDetail()})("onDropdownClick",function(){return s.setActionMenus()}),t.qZA()),2&e&&t.Q6J("model",s.menuItems)},dependencies:[I.a],encapsulation:2}),i})();function nt(i,l){1&i&&(t.TgZ(0,"tr")(1,"th",16),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",17),t._uU(4,"\u0e9b\u0eb0\u0e88\u0eb3\u0e9b\u0eb5"),t.qZA(),t.TgZ(5,"th",17),t._uU(6,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99"),t.qZA(),t.TgZ(7,"th",17),t._uU(8,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99"),t.qZA(),t.TgZ(9,"th",18),t._uU(10,"\u0e81\u0eb2\u0e99\u0ec3\u0eab\u0ec9\u0e84\u0eb0\u0ec1\u0e99\u0e99\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94\u0ec3\u0e99 (4) \u0e94\u0ec9\u0eb2\u0e99"),t.qZA(),t.TgZ(11,"th",17),t._uU(12,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0"),t.qZA(),t.TgZ(13,"th",17),t._uU(14,"\u0e94\u0eb3\u0ec0\u0e99\u0eb5\u0e99\u0e81\u0eb2\u0e99"),t.qZA()(),t.TgZ(15,"tr")(16,"th",19)(17,"div",20)(18,"small"),t._uU(19,"\u0ec0\u0ea7\u0ea5\u0eb2"),t.qZA()()(),t.TgZ(20,"th",19)(21,"div",20)(22,"small"),t._uU(23,"\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),t.qZA()()(),t.TgZ(24,"th",19)(25,"div",20)(26,"small"),t._uU(27,"\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),t.qZA()()(),t.TgZ(28,"th",19)(29,"div",20)(30,"small"),t._uU(31,"\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),t.qZA()()()())}function it(i,l){if(1&i&&(t.TgZ(0,"tr",21)(1,"td",22)(2,"div",23),t._uU(3),t.qZA()()()),2&i){const e=l.$implicit,s=t.oxw();t.xp6(1),t.Q6J("pTooltip",s.utilService.getTooltip(null==e?null:e.taskSubject,25)),t.xp6(2),t.AsE(" \u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81 #",null==e?null:e.taskId,": ",null==e?null:e.taskSubject," ")}}const at=function(){return{width:"50px"}};function st(i,l){if(1&i&&(t.TgZ(0,"tr")(1,"td",24),t._uU(2),t.qZA(),t.TgZ(3,"td",25),t._uU(4),t.qZA(),t.TgZ(5,"td",25),t._uU(6),t.ALo(7,"date"),t.qZA(),t.TgZ(8,"td",25),t._uU(9),t.qZA(),t.TgZ(10,"td",26),t._uU(11),t.qZA(),t.TgZ(12,"td",26),t._uU(13),t.qZA(),t.TgZ(14,"td",26),t._uU(15),t.qZA(),t.TgZ(16,"td",26),t._uU(17),t.qZA(),t.TgZ(18,"td",19),t._UZ(19,"app-task-status",27),t.qZA(),t.TgZ(20,"td",19),t._UZ(21,"app-btn-action",28),t.qZA()()),2&i){const e=l.$implicit,s=l.rowIndex;t.xp6(1),t.Q6J("ngStyle",t.DdM(14,at)),t.xp6(1),t.hij(" ",s+1," "),t.xp6(2),t.hij(" ",null==e?null:e.docYear," "),t.xp6(2),t.hij(" ",t.xi3(7,11,null==e?null:e.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(3),t.hij(" ",null==e?null:e.id," "),t.xp6(2),t.Oqu(null==e?null:e.selfTimeScore),t.xp6(2),t.Oqu(null==e?null:e.selfQuantityScore),t.xp6(2),t.Oqu(null==e?null:e.selfQualityScore),t.xp6(2),t.Oqu(null==e?null:e.selfSatisfiedScore),t.xp6(2),t.Q6J("taskStatus",null==e?null:e.status),t.xp6(2),t.Q6J("task",e)}}function ut(i,l){1&i&&(t.TgZ(0,"tr")(1,"td",29),t._uU(2,"\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99"),t.qZA()())}const ot=function(){return[25,50,100]},lt=[{path:"",component:(()=>{class i{constructor(e,s,_,A,B,S,It,Ut,Rt){this.menuService=e,this.dialogRef=s,this.filter=_,this.utilService=A,this.fb=B,this.sanitizer=S,this.cdr=It,this.selfEvalService=Ut,this.taskHelperService=Rt,this.evaluations=[],this.screenHeight=0,this.filterFields=["taskId","taskSubject","createdAt"],this.showMenu$=this.menuService.menuState$,this.destroy$=new r.x,this.formGroup=this.fb.formGroup(new E.U)}ngOnInit(){this.selfEvalService.items$.pipe((0,f.R)(this.destroy$)).subscribe(e=>{this.evaluations=e,this.cdr.markForCheck()}),this.checkScreenSize()}onResize(e){this.checkScreenSize()}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}onSelectedYear(e){if(e.getFullYear()){const _=e.getFullYear();this.taskHelperService.getTaskReport(_).subscribe()}}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef?.close()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.h),t.Y36(o.E7),t.Y36(d.i),t.Y36(u.F),t.Y36(c.GW),t.Y36(g.H7),t.Y36(t.sBO),t.Y36(v.A),t.Y36(Z.v))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-report-history"]],hostBindings:function(e,s){1&e&&t.NdJ("resize",function(A){return s.onResize(A)},!1,t.Jf7)},decls:19,vars:12,consts:[[1,"p-grid","mt-4"],[1,"p-col-12"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","align-items-center"],[1,"text-2xl","font-semibold","ml-2"],[3,"formGroup"],[3,"yearSelected"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","\u0e84\u0ebb\u0ec9\u0e99\u0eab\u0eb2..",3,"input"],["sortField","id","dataKey","id","sortMode","single","rowGroupMode","subheader","groupRowsBy","taskId","styleClass","p-datatable-sm","responsiveLayout","scroll","currentPageReportTemplate","\u0eaa\u0eb0\u0ec1\u0e94\u0e87 {first} \u0ec0\u0e96\u0eb4\u0e87 {last} \u0e88\u0eb2\u0e81\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 {totalRecords} \u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99",3,"value","rows","paginator","globalFilterFields","rowHover","scrollable","scrollHeight","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","header"],["pTemplate","groupheader"],["pTemplate","body"],["pTemplate","emptymessage"],["rowspan","2",1,"white-space-nowrap","text-center"],["rowspan","2",1,"text-center","white-space-nowrap"],["colspan","4",1,"text-center","white-space-nowrap"],[1,"text-center","white-space-nowrap"],[1,"-rotate-25"],["pRowGroupHeader",""],["colspan","10","tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"text-groupheader","font-semibold","text-xl"],[1,"text-center","white-space-nowrap",3,"ngStyle"],[1,"white-space-nowrap","text-center"],[1,"text-center","white-space-nowrap","font-semibold"],[3,"taskStatus"],[3,"task"],["colspan","10",1,"text-center","py-4"]],template:function(e,s){if(1&e){const _=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),t._uU(5,"\u0e9b\u0eb0\u0eab\u0ea7\u0eb1\u0e94\u0e81\u0eb2\u0e99\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99 \u0ec1\u0ea5\u0eb0 \u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e82\u0ead\u0e87 (\u0e95\u0ebb\u0e99\u0ec0\u0ead\u0e87)"),t.qZA()(),t.TgZ(6,"div",3)(7,"form",5)(8,"app-year-picker",6),t.NdJ("yearSelected",function(B){return s.onSelectedYear(B)}),t.qZA()(),t.TgZ(9,"span",7),t._UZ(10,"i",8),t.TgZ(11,"input",9),t.NdJ("input",function(B){t.CHM(_);const S=t.MAs(14);return t.KtG(s.filter.dataTable(S,B))}),t.qZA()()()(),t._UZ(12,"hr"),t.TgZ(13,"p-table",10,11),t.YNc(15,nt,32,0,"ng-template",12),t.YNc(16,it,4,3,"ng-template",13),t.YNc(17,st,22,15,"ng-template",14),t.YNc(18,ut,3,0,"ng-template",15),t.qZA()()()}2&e&&(t.xp6(7),t.Q6J("formGroup",s.formGroup),t.xp6(6),t.Q6J("value",s.evaluations)("rows",25)("paginator",!0)("globalFilterFields",s.filterFields)("rowHover",!0)("scrollable",!0)("scrollHeight",s.screenHeight+"px")("showCurrentPageReport",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(11,ot)))},dependencies:[a.PC,T._Y,T.JL,T.sg,c.VP,C.iA,D.jx,C.Z5,U.u,R.o,M.h,b.O,et,a.uU],encapsulation:2,changeDetection:0}),i})(),resolve:{data:(()=>{class i{constructor(e){this.taskHelperService=e}resolve(e,s){const _=(new Date).getFullYear();return this.taskHelperService.getTaskReport(_)}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(Z.v))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}];let rt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.Bz.forChild(lt),m.Bz]}),i})();var ct=n(4466),dt=n(585),Et=n(1989),pt=n(5121),mt=n(5047),ft=n(3054),ht=n(613),gt=n(6679),_t=n(2448),vt=n(3241),At=n(1119),Bt=n(1889),yt=n(8455),Ct=n(2008),Tt=n(7368),St=n(9981),xt=n(9615),Zt=n(6749);let Dt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[a.ez,rt,ct.m,C.U$,I.l,gt.W,U.z,P.TX,ht.cc,w.L,dt._8,R.j,mt.L$,ft.A,Ct.l,H.o,pt.Z_,yt.$,Et.nD,I.l,At.H,Bt.P,vt.$,_t.q,Tt.b,St.o,xt.E,Zt.g]}),i})()},830:(y,h,n)=>{n.d(h,{P:()=>p});var a=n(1135),m=n(8505),r=n(4004),f=n(2340),E=n(8274),t=n(529);let p=(()=>{class o{constructor(u){this.http=u,this.apiUrl=`${f.N.apiUrl}/v1/desc-evaluations`,this.item=new a.X(null),this.item$=this.item.asObservable(),this.items=new a.X([]),this.items$=this.items.asObservable()}getOne(u){return this.http.post(`${this.apiUrl}/find`,u).pipe((0,m.b)(g=>{200===g?.statusCode&&g?.data&&this.item.next(g.data)}))}getMany(u){return this.http.post(`${this.apiUrl}/find`,u).pipe((0,m.b)(g=>{200===g?.statusCode&&g?.data&&this.items.next(g.data)}))}update(u,c){return this.http.patch(`${this.apiUrl}/head/${u}`,c).pipe((0,r.U)(v=>{if(200===v?.statusCode&&v?.data){const T=this.items.getValue().map(C=>C.id===u?{...C,...c}:C);return this.items.next(T),!0}return!1}))}updateAndRemove(u,c){return this.http.patch(`${this.apiUrl}/head/${u}`,c).pipe((0,m.b)(v=>{200===v?.statusCode&&this.removeItemFromList(u)}))}removeItemFromList(u){const g=this.items.getValue().filter(v=>v?.id!==u);this.items.next(g)}}return o.\u0275fac=function(u){return new(u||o)(E.LFG(t.eN))},o.\u0275prov=E.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})()},3054:(y,h,n)=>{n.d(h,{A:()=>E,g:()=>f});var a=n(8274),m=n(6895),r=n(433);let f=(()=>{class t{constructor(o,d,u,c){this.el=o,this.ngModel=d,this.control=u,this.cd=c,this.onResize=new a.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(o){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(o){this.autoResize&&this.resize(o)}onBlur(o){this.autoResize&&this.resize(o)}resize(o){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(o||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(a.Y36(a.SBq),a.Y36(r.On,8),a.Y36(r.a5,8),a.Y36(a.sBO))},t.\u0275dir=a.lG2({type:t,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(o,d){1&o&&a.NdJ("input",function(c){return d.onInput(c)})("focus",function(c){return d.onFocus(c)})("blur",function(c){return d.onBlur(c)}),2&o&&a.ekj("p-filled",d.filled)("p-inputtextarea-resizable",d.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),t})(),E=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=a.oAB({type:t}),t.\u0275inj=a.cJS({imports:[m.ez]}),t})()}}]);