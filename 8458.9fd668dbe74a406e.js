"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[8458],{3948:(D,B,e)=>{e.d(B,{h:()=>x});var r=e(8274),m=e(6895),A=e(6679);const _=function(g){return{background:g}};function t(g,f){if(1&g&&(r.ynx(0),r.TgZ(1,"p-tag",1)(2,"div",2),r._UZ(3,"i",3),r.TgZ(4,"span",4),r._uU(5),r.qZA()()(),r.BQk()),2&g){const d=f.ngIf;r.xp6(1),r.Akn(r.VKq(6,_,d.color)),r.Q6J("rounded",!0),r.xp6(2),r.Tol(d.icon),r.xp6(2),r.Oqu(d.name)}}let x=(()=>{class g{constructor(){}ngOnInit(){}trackByFn(d,c){return c.id||d}}return g.\u0275fac=function(d){return new(d||g)},g.\u0275cmp=r.Xpm({type:g,selectors:[["app-task-status"]],inputs:{taskStatus:"taskStatus"},decls:1,vars:1,consts:[[4,"ngIf"],["styleClass","px-3",3,"rounded"],[1,"flex","align-items-center","gap-1"],[2,"font-size","11px"],[1,"font-semibold",2,"font-size","11px"]],template:function(d,c){1&d&&r.YNc(0,t,6,8,"ng-container",0),2&d&&r.Q6J("ngIf",c.taskStatus)},dependencies:[m.O5,A.V],encapsulation:2}),g})()},9504:(D,B,e)=>{e.d(B,{w:()=>f});var r=e(1135),m=e(4004),A=e(8505),_=e(2340),t=e(8274),x=e(529),g=e(3678);let f=(()=>{class d{constructor(s,a){this.http=s,this.planSubWfService=a,this.apiUrl=`${_.N.apiUrl}/v1/plan-sub-evaluations`,this.item=new r.X({}),this.item$=this.item.asObservable(),this.items=new r.X([]),this.items$=this.items.asObservable()}create(s){return this.http.post(this.apiUrl,s).pipe((0,m.U)(a=>{if(201===a.statusCode&&a.data)return this.planSubWfService.updateItems(a.data),a.data}))}getOne(s){return this.http.post(`${this.apiUrl}/find`,s).pipe((0,A.b)(u=>{200===u?.statusCode&&u?.data&&this.item.next(u.data)}))}getOneAndReplace(s){return this.http.post(`${this.apiUrl}/find`,s).pipe((0,A.b)(u=>{if(200===u?.statusCode&&u?.data){const o=u.data,E=this.items.getValue();if(-1!==E.findIndex(h=>h.id===o.id)){const h=E.map(b=>b.id===o.id?{...b,...o}:b);this.items.next([...h])}}}))}getMany(s){return this.http.post(`${this.apiUrl}/find`,s).pipe((0,A.b)(u=>{200===u?.statusCode&&u?.data&&this.items.next(u.data)}))}update(s,a){return this.http.patch(`${this.apiUrl}/${s}`,a).pipe((0,A.b)(o=>200===o?.statusCode))}deleteOne(s){return this.http.delete(`${this.apiUrl}/${s}`).pipe((0,m.U)(u=>200===u?.statusCode),(0,A.b)(u=>{u&&this.removeItemFromList(s)}))}removeItemFromList(s){const u=this.items.getValue().filter(o=>o?.id!==s);this.items.next(u)}}return d.\u0275fac=function(s){return new(s||d)(t.LFG(x.eN),t.LFG(g.K))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},3119:(D,B,e)=>{e.d(B,{$:()=>g});var r=e(4004),m=e(8505),A=e(1135),_=e(2340),t=e(8274),x=e(529);let g=(()=>{class f{constructor(c){this.http=c,this.apiUrl=`${_.N.apiUrl}/v1/plan-main-wf`,this.planSubApiUrl=`${_.N.apiUrl}/v1/plan-subs`,this.items=new A.X([]),this.items$=this.items.asObservable()}create(c){return this.http.post(this.apiUrl,c).pipe((0,r.U)(s=>!(201!==s?.statusCode||!s?.data)))}addNewSubTask(c,s){const a=this.items.getValue(),u=a.findIndex(o=>o.id===c);if(-1!==u){const o={...a[u]};o.planMain||(o.planMain={planSubs:[]});const E=o.planMain.planSubs||[];E.unshift(s),E.sort((S,h)=>h.id-S.id),o.planMain.planSubs=E,a[u]=o,this.items.next([...a])}}getMany(c){return this.http.post(`${this.apiUrl}/find`,c).pipe((0,m.b)(a=>{200===a?.statusCode&&a?.data&&this.items.next(a.data)}))}getManyPlanSub(c,s){return this.http.post(`${this.planSubApiUrl}/find`,s).pipe((0,m.b)(u=>{if(200===u?.statusCode&&u?.data){const o=u.data,E=this.items.getValue(),S=E.find(h=>h.planMainId===c);S&&(S.planSubs=o,this.items.next(E))}}))}getOnePlanSubAndReplace(c){return this.http.post(this.planSubApiUrl,c).pipe((0,m.b)(a=>{}))}updateWorkflow(c,s,a){const u=this.items.getValue(),o=u.findIndex(E=>E.id===c);if(-1!==o){const E={...u[o]};E.planMain||(E.planMain={planSubs:[]});const S=E.planMain.planSubs||[],h=S.findIndex(b=>b.id===s);if(-1!==h){const b={...S[h]};b.planSubWf=a,S[h]=b,E.planMain.planSubs=S,u[o]=E,this.items.next([...u])}}}getAll(c,s){return this.http.get(`${this.apiUrl}/${c}`,{params:s}).pipe((0,m.b)(u=>{200===u?.statusCode&&u?.data&&this.items.next(u.data)}))}removePlanSub(c,s){const a=this.items.getValue(),u=a.findIndex(o=>o?.id===c);if(-1!==u){const o=a[u],E=o.planSubs?.filter(b=>b.id!==s)||[],S={...o,planSubs:E},h=[...a.slice(0,u),S,...a.slice(u+1)];this.items.next(h)}}deleteMany(c){return this.http.delete(`${this.apiUrl}/${c}`).pipe((0,r.U)(a=>200===a?.statusCode))}}return f.\u0275fac=function(c){return new(c||f)(t.LFG(x.eN))},f.\u0275prov=t.Yz7({token:f,factory:f.\u0275fac,providedIn:"root"}),f})()},3678:(D,B,e)=>{e.d(B,{K:()=>f});var r=e(4004),m=e(8505),A=e(1135),_=e(2340),t=e(8274),x=e(529),g=e(3119);let f=(()=>{class d{constructor(s,a){this.http=s,this.planMainWfService=a,this.apiUrl=`${_.N.apiUrl}/v1/plan-sub-wf-staffs`,this.items=new A.X([]),this.items$=this.items.asObservable(),this.item=new A.X(null),this.item$=this.item.asObservable()}create(s,a,u){return this.http.post(this.apiUrl,u).pipe((0,r.U)(o=>!(201!==o?.statusCode||!o?.data||(this.planMainWfService.updateWorkflow(s,a,o.data),0))))}forwardWf(s){return this.http.post(`${this.apiUrl}/forward`,s).pipe((0,m.b)(u=>{201===u?.statusCode&&u?.data&&this.updateItems(u.data)}))}getOne(s){return this.http.post(`${this.apiUrl}/find`,s).pipe((0,m.b)(u=>{200===u?.statusCode&&u?.data&&this.item.next(u.data)}))}getMany(s){return this.http.post(`${this.apiUrl}/find`,s).pipe((0,m.b)(u=>{200===u?.statusCode&&u?.data&&this.items.next(u.data)}))}update(s,a){return this.http.patch(this.apiUrl,a,{params:s}).pipe((0,m.b)(u=>{if(200===u?.statusCode&&u?.data){const o=u.data,S=this.items.getValue().map(h=>h?.id===o.id?o:h);this.items.next(S)}}))}pickup(s,a){return this.http.patch(`${this.apiUrl}/pickup`,a,{params:s}).pipe((0,m.b)(o=>{200===o?.statusCode&&o?.data&&this.updateItems(o.data)}))}deleteMany(s){return this.http.delete(`${this.apiUrl}/${s}`).pipe((0,r.U)(u=>200===u?.statusCode))}updateItems(s){const u=this.items.getValue().map(o=>o?.id===s.id?{...o,status:s.status}:o);this.items.next(u)}}return d.\u0275fac=function(s){return new(s||d)(t.LFG(x.eN),t.LFG(g.$))},d.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},107:(D,B,e)=>{e.r(B),e.d(B,{PlanSubInBranchModule:()=>At});var r=e(6895),m=e(5675),A=e(7579),_=e(2722),t=e(8274),x=e(6832),g=e(1094),f=e(7593),d=e(8145),c=e(4325),s=e(793),a=e(805),u=e(1740),o=e(7147),E=e(5593),S=e(3608),h=e(3948),b=e(7489),y=e(7448);class O{static getDetail(p){return{query:{fields:["main.id","main.docYear","main.createdAt","main.remark","creator.staffCode","creator.firstName","creator.lastName","planSub.id","planSub.taskSubject","planSub.taskWeight","planSub.indicatorTime","planSub.indicatorQuantity","psubIq.id","psubIq.subject","psubIs.id","psubIs.subject","wfStatus.id","wfStatus.name","wfStatus.icon","wfStatus.color"],joins:["creator","planSub","psubIq","psubIs","wfStatus"],filters:p,getType:"ONE"}}}}var P=e(6679);function k(i,p){if(1&i&&(t.TgZ(0,"div",9)(1,"label",8),t._uU(2,"\u0e82\u0ecd\u0ec9\u0e84\u0ea7\u0eb2\u0ea1\u0e88\u0eb2\u0e81\u0e9c\u0eb9\u0ec9\u0ea1\u0ead\u0e9a\u0e95\u0ecd\u0ec8"),t.qZA(),t.TgZ(3,"div"),t._uU(4),t.qZA()()),2&i){const n=t.oxw(2).ngIf;t.xp6(4),t.hij(" ",n.remark," ")}}const W=function(){return{width:"50px"}};function R(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"div",4)(2,"div")(3,"label",5),t._uU(4,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d:"),t.qZA()(),t._uU(5),t.ALo(6,"date"),t.qZA(),t.TgZ(7,"div",6)(8,"div")(9,"label",5),t._uU(10,"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec2\u0e94\u0e8d:"),t.qZA()(),t.TgZ(11,"span",7),t._uU(12),t.qZA()(),t.TgZ(13,"div")(14,"label",8),t._uU(15),t.qZA()(),t.TgZ(16,"div",9)(17,"label",8),t._uU(18,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(19,"div"),t._uU(20),t.qZA()(),t.TgZ(21,"div",6)(22,"div")(23,"label",5),t._uU(24,"\u0e99\u0ec9\u0eb3\u0edc\u0eb1\u0e81:"),t.qZA()(),t._UZ(25,"p-tag",10),t.qZA(),t.TgZ(26,"div",9)(27,"label",11),t._uU(28,"\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94:"),t.qZA(),t.TgZ(29,"ul")(30,"li")(31,"span",12),t._uU(32,"\u0e94\u0ec9\u0eb2\u0e99\u0ec0\u0ea7\u0ea5\u0eb2: "),t.qZA(),t.TgZ(33,"span"),t._uU(34),t.ALo(35,"date"),t.qZA()(),t.TgZ(36,"li")(37,"span",12),t._uU(38,"\u0e94\u0ec9\u0eb2\u0e99\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99: "),t.qZA(),t.TgZ(39,"span"),t._uU(40),t.qZA()(),t.TgZ(41,"li")(42,"span",12),t._uU(43,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a:"),t.qZA(),t._UZ(44,"br"),t.TgZ(45,"span"),t._uU(46),t.qZA()(),t.TgZ(47,"li")(48,"span",12),t._uU(49,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88:"),t.qZA(),t._UZ(50,"br"),t.TgZ(51,"span"),t._uU(52),t.qZA()()()(),t.YNc(53,k,5,1,"div",13),t.TgZ(54,"div",14)(55,"div")(56,"label",5),t._uU(57,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0:"),t.qZA()(),t._UZ(58,"app-task-status",15),t.qZA(),t.BQk()),2&i){const n=p.ngIf,l=t.oxw().ngIf;t.xp6(5),t.hij(" ",t.xi3(6,16,null==l?null:l.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(6),t.Q6J("pTooltip",null==l||null==l.creator?null:l.creator.staffCode),t.xp6(1),t.AsE(" ",null==l||null==l.creator?null:l.creator.firstName," ",null==l||null==l.creator?null:l.creator.lastName," "),t.xp6(3),t.hij("\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d: ",null==n?null:n.id,""),t.xp6(5),t.Oqu(null==n?null:n.taskSubject),t.xp6(5),t.Akn(t.DdM(22,W)),t.Q6J("value",(null==n?null:n.taskWeight)+"%")("rounded",!0),t.xp6(9),t.Oqu(t.xi3(35,19,null==n?null:n.indicatorTime,"dd/MM/yyyy HH:mm")),t.xp6(6),t.Oqu(null==n?null:n.indicatorQuantity),t.xp6(6),t.Oqu(null==n||null==n.indicatorQuality?null:n.indicatorQuality.subject),t.xp6(6),t.Oqu(null==n||null==n.indicatorSatisfied?null:n.indicatorSatisfied.subject),t.xp6(1),t.Q6J("ngIf",null==l?null:l.remark),t.xp6(5),t.Q6J("taskStatus",null==l?null:l.status)}}function $(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"div",3),t.YNc(2,R,59,23,"ng-container",2),t.qZA(),t.BQk()),2&i){const n=p.ngIf;t.xp6(2),t.Q6J("ngIf",null==n?null:n.planSub)}}let j=(()=>{class i{constructor(n,l){this.dialogConfig=n,this.wfOfficeService=l}ngOnInit(){this.workflowId=this.dialogConfig.data.data,this.workflowId&&this.getPlanSubDetail()}getPlanSubDetail(){this.workflow$=this.wfOfficeService.item$;const n=Object.assign({id:this.workflowId}),l=O.getDetail(n);this.wfOfficeService.getOne(l).subscribe()}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(c.S),t.Y36(f.f))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-detail"]],decls:4,vars:3,consts:[[1,"grid"],[1,"col-12"],[4,"ngIf"],[1,"p-fluid"],[1,"flex","align-items-center","gap-2"],[1,"font-semibold","text-xl"],[1,"field","flex","align-items-center","gap-2"],["tooltipPosition","bottom",3,"pTooltip"],[1,"font-semibold","text-xl","mb-0"],[1,"field"],["severity","success",3,"value","rounded"],[1,"font-semibold","mb-0","text-xl"],[1,"font-semibold"],["class","field",4,"ngIf"],[1,"field","field","flex","align-items-center","gap-2"],[3,"taskStatus"]],template:function(n,l){1&n&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,$,3,1,"ng-container",2),t.ALo(3,"async"),t.qZA()()),2&n&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,1,l.workflow$)))},dependencies:[r.O5,P.V,S.u,h.h,r.Ov,r.uU],encapsulation:2}),i})();var Q=e(3535),T=e(4090),Z=e(209),Y=e(704),L=e(3678),U=e(8386),M=e(605);function N(i,p){if(1&i){const n=t.EpF();t.ynx(0),t.TgZ(1,"p-splitButton",1),t.NdJ("onClick",function(){t.CHM(n);const v=t.oxw();return t.KtG(v.showDetail())})("onDropdownClick",function(){t.CHM(n);const v=t.oxw();return t.KtG(v.onDropdownClick())}),t.qZA(),t.BQk()}if(2&i){const n=t.oxw();t.xp6(1),t.Q6J("model",n.menuItems)}}let K=(()=>{class i{constructor(n,l,v,I,C,w,bt){this.dialogRef=n,this.alertService=l,this.dialogService=v,this.staffWfService=I,this.officeWfService=C,this.userService=w,this.confirmService=bt,this.menuItems=[]}ngOnInit(){this.user=this.userService.getLoggedUser(),this.task=this.workflow?.planSub,this.planSub=this.workflow?.planSub,this.statusId=this.workflow?.status?.id,this.workflowId=this.workflow?.id}onDropdownClick(){this.user?.role?.id<14?this.statusId===T.hY.WAIT_PICK_JOB?this.menuItems=[{label:"\u0eae\u0eb1\u0e9a\u0ea7\u0ebd\u0e81\u0ec0\u0ead\u0e87",icon:"pi pi-fw pi-check",command:()=>{this.onPickup()}},{label:"\u0ea1\u0ead\u0e9a\u0ea7\u0ebd\u0e81\u0e95\u0ecd\u0ec8",icon:"pi pi-fw pi-share-alt",command:()=>{this.onForward()}}]:(this.statusId===T.hY.IN_PROGRESS||this.statusId===T.hY.WAIT_REPORT)&&(this.menuItems=[{label:"\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99",icon:"pi pi-fw pi-send",command:()=>{this.onReport()}}]):this.statusId===T.hY.WAIT_PICK_JOB?this.menuItems=[{label:"\u0eae\u0eb1\u0e9a\u0ea7\u0ebd\u0e81",icon:"pi pi-fw pi-check",command:()=>{this.onPickup()}}]:(this.statusId===T.hY.IN_PROGRESS||this.statusId===T.hY.WAIT_REPORT)&&(this.menuItems=[{label:"\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99",icon:"pi pi-fw pi-send",command:()=>{this.onReport()}}])}showDetail(){if(this.workflowId)return this.dialogService.open(j,{header:`\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94 #${this.workflowId}`,width:window.innerWidth>Z.A.lg?"65%":"80%",data:{data:this.workflowId},contentStyle:{overflow:"auto","padding-bottom":"60px"},baseZIndex:1e4,dismissableMask:!1,maximizable:!0})}onPickup(){this.workflowId&&this.confirmService.confirm({message:"\u0ec1\u0e99\u0ec8\u0ec3\u0e88\u0e9a\u0ecd\u0ec8\u0ea7\u0ec8\u0eb2\u0e95\u0ec9\u0ead\u0e87\u0e81\u0eb2\u0e99\u0eae\u0eb1\u0e9a\u0ea7\u0ebd\u0e81\u0ec0\u0ead\u0e87, \u0e97\u0ec8\u0eb2\u0e99\u0e88\u0eb0\u0e9a\u0ecd\u0ec8\u0eaa\u0eb2\u0ea1\u0eb2\u0e94\u0ea1\u0ead\u0e9a\u0ea7\u0ebd\u0e81\u0e95\u0ecd\u0ec8\u0ec4\u0e94\u0ec9\u0ec3\u0e99\u0e9e\u0eb2\u0e8d\u0eab\u0ebc\u0eb1\u0e87?",icon:"pi pi-exclamation-triangle",accept:()=>{const n=this.planSub?.id,l=this.workflow?.id;this.onExecPickup(n,l)}})}onExecPickup(n,l){if(n&&l){const v={parentWfId:n,childId:l},I=Object.assign({statusId:T.hY.IN_PROGRESS});this.officeWfService.pickup(v,I).subscribe({next:()=>{this.alertService.showSuccess("\u0eae\u0eb1\u0e9a\u0ea7\u0ebd\u0e81\u0ec1\u0ea5\u0ec9\u0ea7")},error:C=>{this.alertService.showError(C)}})}}onForward(){this.workflowId&&(this.dialogRef=this.dialogService.open(y.G,{header:`\u0ea1\u0ead\u0e9a\u0ea7\u0ebd\u0e81\u0e95\u0ecd\u0ec8 #${this.planSub?.id}`,width:window.innerWidth>Z.A.lg?"50%":"80%",data:{data:(0,b.cloneDeep)(this.workflow),isOffice:!0},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,dismissableMask:!1,maximizable:!0}))}onReport(){this.workflow&&(this.dialogRef=this.dialogService.open(Q.K,{header:`\u0e81\u0eb2\u0e99\u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99 \u0ec1\u0ea5\u0eb0 \u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81 #${this.task?.id}`,width:window.innerWidth>Z.A.lg?"65%":"80%",data:{data:(0,b.cloneDeep)(this.workflow)},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,dismissableMask:!1,maximizable:!0}))}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(c.E7),t.Y36(Y.c),t.Y36(c.xA),t.Y36(L.K),t.Y36(f.f),t.Y36(U.K),t.Y36(a.YP))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-btn-action"]],inputs:{workflow:"workflow"},decls:1,vars:1,consts:[[4,"ngIf"],["appendTo","body","label","\u0ec0\u0e9a\u0eb4\u0ec8\u0e87\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94","styleClass","p-button-secondary p-button-sm",3,"model","onClick","onDropdownClick"]],template:function(n,l){1&n&&t.YNc(0,N,2,1,"ng-container",0),2&n&&t.Q6J("ngIf",l.workflow)},dependencies:[r.O5,M.a],encapsulation:2}),i})();function F(i,p){if(1&i){const n=t.EpF();t.TgZ(0,"div")(1,"p-button",14),t.NdJ("click",function(){t.CHM(n);const v=t.oxw();return t.KtG(v.menuService.showMenu())}),t.qZA()()}}function J(i,p){if(1&i){const n=t.EpF();t.TgZ(0,"div")(1,"p-button",15),t.NdJ("click",function(){t.CHM(n);const v=t.oxw();return t.KtG(v.menuService.hideMenu())}),t.qZA()()}}function z(i,p){1&i&&(t.TgZ(0,"tr")(1,"th",16),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",17),t._uU(4,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d"),t.qZA(),t.TgZ(5,"th",17),t._uU(6,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d"),t.qZA(),t.TgZ(7,"th",17),t._uU(8,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(9,"th",18),t._uU(10,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(11,"th",17),t._uU(12,"\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA(),t.TgZ(13,"th",17),t._uU(14,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0"),t.qZA(),t.TgZ(15,"th",17),t._uU(16,"\u0e94\u0eb3\u0ec0\u0e99\u0eb5\u0e99\u0e81\u0eb2\u0e99"),t.qZA()())}function H(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"p-chip",20)(2,"div",27),t._uU(3,"\u0ec0\u0ea7\u0ea5\u0eb2"),t.qZA()(),t.BQk()),2&i){const n=t.oxw().$implicit,l=t.oxw();t.xp6(1),t.Q6J("pTooltip",l.utilService.dateTimeShortFormat(null==n||null==n.planSub?null:n.planSub.indicatorTime))}}function G(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"p-chip",20)(2,"div",27),t._uU(3,"\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),t.qZA()(),t.BQk()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n||null==n.planSub?null:n.planSub.indicatorQuantity)}}function V(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"p-chip",20)(2,"div",27),t._uU(3,"\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),t.qZA()(),t.BQk()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n||null==n.planSub||null==n.planSub.indicatorQuality?null:n.planSub.indicatorQuality.subject)}}function X(i,p){if(1&i&&(t.ynx(0),t.TgZ(1,"p-chip",20)(2,"div",27),t._uU(3,"\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),t.qZA()(),t.BQk()),2&i){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n||null==n.planSub||null==n.planSub.indicatorSatisfied?null:n.planSub.indicatorSatisfied.subject)}}const q=function(){return{width:"50px"}};function tt(i,p){if(1&i&&(t.TgZ(0,"tr")(1,"td",19),t._uU(2),t.qZA(),t.TgZ(3,"td",17),t._uU(4),t.ALo(5,"date"),t.qZA(),t.TgZ(6,"td",17),t._uU(7),t.qZA(),t.TgZ(8,"td",17),t._uU(9),t.qZA(),t.TgZ(10,"td",20)(11,"div",21),t._uU(12),t.qZA()(),t.TgZ(13,"td",22)(14,"div",23),t.YNc(15,H,4,1,"ng-container",4),t.YNc(16,G,4,1,"ng-container",4),t.YNc(17,V,4,1,"ng-container",4),t.YNc(18,X,4,1,"ng-container",4),t.qZA()(),t.TgZ(19,"td",24),t._UZ(20,"app-task-status",25),t.qZA(),t.TgZ(21,"td",17),t._UZ(22,"app-btn-action",26),t.qZA()()),2&i){const n=p.$implicit,l=p.rowIndex;t.xp6(1),t.Q6J("ngStyle",t.DdM(16,q)),t.xp6(1),t.hij(" ",l+1," "),t.xp6(2),t.hij(" ",t.xi3(5,13,null==n?null:n.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(3),t.hij(" ",null==n?null:n.id," "),t.xp6(2),t.hij(" ",null==n||null==n.planSub?null:n.planSub.id," "),t.xp6(1),t.Q6J("pTooltip",(null==n||null==n.subject?null:n.subject.length)>25?null==n?null:n.subject:null),t.xp6(2),t.hij(" ",null==n||null==n.planSub?null:n.planSub.subject," "),t.xp6(3),t.Q6J("ngIf",null==n||null==n.planSub?null:n.planSub.indicatorTime),t.xp6(1),t.Q6J("ngIf",null==n||null==n.planSub?null:n.planSub.indicatorQuantity),t.xp6(1),t.Q6J("ngIf",null==n||null==n.planSub||null==n.planSub.indicatorQuality?null:n.planSub.indicatorQuality.id),t.xp6(1),t.Q6J("ngIf",null==n||null==n.planSub||null==n.planSub.indicatorSatisfied?null:n.planSub.indicatorSatisfied.id),t.xp6(2),t.Q6J("taskStatus",null==n?null:n.status),t.xp6(2),t.Q6J("workflow",n)}}function nt(i,p){1&i&&(t.TgZ(0,"tr")(1,"td",28),t._uU(2,"\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99"),t.qZA()())}const et=function(){return[25,50,100]};let it=(()=>{class i{constructor(n,l,v,I,C,w){this.filter=n,this.utilService=l,this.cdr=v,this.planSubWfService=I,this.menuService=C,this.dialogRef=w,this.workflows=[],this.filterFields=["id","subject"],this.screenHeight=0,this.showMenu$=this.menuService.menuState$,this.destroy$=new A.x}ngOnInit(){this.planSubWfService.items$.pipe((0,_.R)(this.destroy$)).subscribe(n=>{this.workflows=n,this.cdr.markForCheck()}),this.checkScreenSize()}onResize(n){this.checkScreenSize()}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef&&this.dialogRef.close()}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(x.i),t.Y36(g.F),t.Y36(t.sBO),t.Y36(f.f),t.Y36(d.h),t.Y36(c.E7))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-plan-sub-in-branch"]],hostBindings:function(n,l){1&n&&t.NdJ("resize",function(I){return l.onResize(I)},!1,t.Jf7)},decls:20,vars:15,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","align-items-center"],[4,"ngIf"],[1,"text-2xl","font-semibold","ml-2"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","\u0e84\u0ebb\u0ec9\u0e99\u0eab\u0eb2..",3,"input"],["scrollHeight","550px","styleClass","p-datatable-sm","currentPageReportTemplate","\u0eaa\u0eb0\u0ec1\u0e94\u0e87 {first} \u0ec0\u0e96\u0eb4\u0e87 {last} \u0e88\u0eb2\u0e81\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 {totalRecords} \u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99",3,"value","rows","paginator","globalFilterFields","rowHover","scrollable","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["icon","pi pi-chevron-right","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],["icon","pi pi-chevron-left","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],[1,"text-center"],[1,"white-space-nowrap","text-center"],[1,"white-space-nowrap"],[1,"text-center",3,"ngStyle"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"max-w-15rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[1,"cursor-pointer"],[1,"flex","gap-1","align-items-center","justify-content-center"],[1,"text-center","white-space-nowrap"],[3,"taskStatus"],[3,"workflow"],[1,"text-xs","white-space-nowrap"],["colspan","8",1,"text-center","py-4"]],template:function(n,l){if(1&n){const v=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.YNc(4,F,2,0,"div",4),t.ALo(5,"async"),t.YNc(6,J,2,0,"div",4),t.ALo(7,"async"),t.TgZ(8,"span",5),t._uU(9,"\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d\u0ec1\u0e9c\u0e99\u0eaa\u0eb9\u0ec9\u0e8a\u0ebb\u0e99\u0e97\u0eb5\u0ec8\u0ec4\u0e94\u0ec9\u0eae\u0eb1\u0e9a\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d"),t.qZA()(),t.TgZ(10,"div")(11,"span",6),t._UZ(12,"i",7),t.TgZ(13,"input",8),t.NdJ("input",function(C){t.CHM(v);const w=t.MAs(16);return t.KtG(l.filter.dataTable(w,C))}),t.qZA()()()(),t._UZ(14,"hr"),t.TgZ(15,"p-table",9,10),t.YNc(17,z,17,0,"ng-template",11),t.YNc(18,tt,23,17,"ng-template",12),t.YNc(19,nt,3,0,"ng-template",13),t.qZA()()()}2&n&&(t.xp6(4),t.Q6J("ngIf",!t.lcZ(5,10,l.showMenu$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,12,l.showMenu$)),t.xp6(9),t.Q6J("value",l.workflows)("rows",25)("paginator",!0)("globalFilterFields",l.filterFields)("rowHover",!0)("scrollable",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(14,et)))},dependencies:[r.O5,r.PC,s.iA,a.jx,u.o,o.A,E.zx,S.u,h.h,K,r.Ov,r.uU],encapsulation:2}),i})();var ut=e(7053);const at=[{path:"",component:it,resolve:{data:(()=>{class i{constructor(n,l){this.officeWfService=n,this.userService=l,this.user=this.userService.getLoggedUser()}resolve(n,l){const v=this.user?.profile?.office?.id,I=Object.assign({officeId:v}),C=ut.e.getMany(I);return this.officeWfService.getMany(C)}}return i.\u0275fac=function(n){return new(n||i)(t.LFG(f.f),t.LFG(U.K))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()}}];let st=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.Bz.forChild(at),m.Bz]}),i})();var lt=e(4466),ot=e(8639),rt=e(585),ct=e(1493),pt=e(2946),dt=e(3054),Et=e(613),ft=e(2453),mt=e(9761),ht=e(2448),gt=e(3241),vt=e(9981),St=e(1291);let At=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[c.E7,c.xA],imports:[r.ez,st,lt.m,s.U$,u.j,dt.A,P.W,o.o,ct.S,ft.EV,ot.TX,pt.L,rt._8,Et.cc,M.l,gt.$,ht.q,mt.P,St.r,vt.o]}),i})()},7053:(D,B,e)=>{e.d(B,{e:()=>r});class r{static getMany(A){return{query:{fields:["main.docYear","main.id","main.createdAt","creator.staffCode","creator.firstName","creator.lastName","planSub.id","planSub.taskSubject","planSub.taskWeight","planSub.indicatorTime","planSub.indicatorQuantity","psubIq.id","psubIq.subject","psubIs.id","psubIs.subject","wfStatus.id","wfStatus.name","wfStatus.icon","wfStatus.color"],joins:["creator","planSub","psubIq","psubIs","psubStatus","wfStatus"],filters:A,getType:"MANY"}}}}}}]);