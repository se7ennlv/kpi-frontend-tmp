"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[7515],{7515:(It,y,u)=>{u.r(y),u.d(y,{ApprDivisionModule:()=>bt});var p=u(6895),w=u(5675),d=u(7579),m=u(655),a=u(2156);class Z{}(0,m.gn)([(0,a.C1)()],Z.prototype,"batchMonth",void 0),(0,m.gn)([(0,a.C1)()],Z.prototype,"divisionId",void 0);class C{}(0,m.gn)([(0,a.C1)()],C.prototype,"gradeApproved",void 0),(0,m.gn)([(0,a.C1)()],C.prototype,"comment",void 0);var t=u(8274),g=u(4325),H=u(841),Q=u(4004),$=u(2340),G=u(529);let I=(()=>{class n{constructor(e){this.http=e,this.apiUrl=`${$.N.apiUrl}/v1/appr-divisions`}create(e){return this.http.post(this.apiUrl,e).pipe((0,Q.U)(o=>201===o?.statusCode))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(G.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var M=u(704),s=u(433),_=u(666),q=u(3054),h=u(5593);function F(n,i){if(1&n&&(t.TgZ(0,"small",13),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.gradeApproved.errors.required?null:e.controls.gradeApproved.errors.required.message," ")}}function L(n,i){if(1&n&&(t.TgZ(0,"small",13),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.comment.errors.required?null:e.controls.comment.errors.required.message," ")}}let R=(()=>{class n{constructor(e,o,l,r,c,E){this.fb=e,this.dialogRef=o,this.dialogConfig=l,this.formService=r,this.approveService=c,this.alertService=E,this.submitted=!1,this.gradeList=[],this.formGroup=this.fb.formGroup(new C),a.jc.set(this.formService.validationMessages)}get controls(){return this.formGroup.controls}ngOnInit(){this.parentData=this.dialogConfig.data.data,this.gradeList=[{id:1,code:"A",description:"A (90-100)"},{id:2,code:"B",description:"B (75-89)"},{id:3,code:"C",description:"C (60-74)"},{id:4,code:"D",description:"D (30-59)"},{id:5,code:"F",description:"F (< 30)"}]}onApprove(){if(this.submitted=!0,this.formGroup.invalid)return;this.formGroup.disable();const e={...this.parentData,...this.formGroup.value,isAdjust:!0};this.approveService.create(e).subscribe({next:o=>{o&&(this.dialogRef&&this.dialogRef.close(),this.alertService.showSuccess("\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99\u0ec1\u0ea5\u0ec9\u0ea7"))},error:o=>{this.formGroup.enable(),this.alertService.showError(o)}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(a.GW),t.Y36(g.E7),t.Y36(g.S),t.Y36(H.k),t.Y36(I),t.Y36(M.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-approve-modal"]],decls:17,vars:4,consts:[[1,"grid"],[1,"col-12"],[3,"formGroup"],[1,"formgrid","grid","p-fluid"],[1,"field","col-12"],["for","gradeApproved",1,"font-semibold","text-lg","mb-0"],["class","p-error",4,"ngIf"],["optionValue","code","optionLabel","description","placeholder","\u0ec0\u0ea5\u0eb7\u0ead\u0e81","formControlName","gradeApproved",3,"options"],["for","comment",1,"font-semibold","text-lg","mb-0"],["rows","5","cols","20","pInputTextarea","","formControlName","comment",1,"w-full"],[1,"mt-5","text-right"],["pButton","","pRipple","","icon","pi pi-times","label","\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81",1,"p-button-outlined",3,"click"],["pButton","","pRipple","","icon","pi pi-check","label","\u0ead\u0eb0\u0e99\u0eb8\u0ea1\u0eb1\u0e94",1,"ml-2",3,"click"],[1,"p-error"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"form",2)(3,"div",3)(4,"div",4)(5,"label",5),t._uU(6,"\u0ec0\u0e81\u0ea3\u0e94 "),t.YNc(7,F,2,1,"small",6),t.qZA(),t._UZ(8,"p-dropdown",7),t.qZA(),t.TgZ(9,"div",4)(10,"label",8),t._uU(11,"\u0e84\u0eb3\u0ec0\u0eab\u0eb1\u0e99 "),t.YNc(12,L,2,1,"small",6),t.qZA(),t._UZ(13,"textarea",9),t.qZA()()()()(),t.TgZ(14,"div",10)(15,"button",11),t.NdJ("click",function(){return o.dialogRef.close()}),t.qZA(),t.TgZ(16,"button",12),t.NdJ("click",function(){return o.onApprove()}),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.formGroup),t.xp6(5),t.Q6J("ngIf",o.submitted&&o.controls.gradeApproved.errors),t.xp6(1),t.Q6J("options",o.gradeList),t.xp6(4),t.Q6J("ngIf",o.submitted&&o.controls.comment.errors))},dependencies:[p.O5,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,a.bc,a.VP,a.YE,_.Lt,q.g,h.Hq],encapsulation:2}),n})();var T=u(6832),B=u(8145),x=u(1094),z=u(8039),v=u(805),P=u(8386),Y=u(1383),A=u(8639),S=u(2722),J=u(8286),j=u(1490),b=u(2946),f=u(793),D=u(3608),k=u(8235);function O(n,i){1&n&&(t.TgZ(0,"div",7)(1,"span",8),t._uU(2,"\u0e9c\u0ebb\u0e99\u0e81\u0eb2\u0e99\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0ea7\u0ebd\u0e81\u0ec1\u0e9c\u0e99\u0eaa\u0eb9\u0ec9\u0e8a\u0ebb\u0e99"),t.qZA()())}function V(n,i){1&n&&(t.TgZ(0,"tr")(1,"th",9),t._uU(2,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0eab\u0ebc\u0eb1\u0e81"),t.qZA(),t.TgZ(3,"th",10),t._uU(4,"\u0e99\u0ec9\u0eb3\u0edc\u0eb1\u0e81"),t.qZA(),t.TgZ(5,"th",10),t._uU(6,"\u0ec1\u0e9c\u0e99 "),t._UZ(7,"br"),t._uU(8," \u0ec3\u0e99\u0ec0\u0e94\u0eb7\u0ead\u0e99"),t.qZA(),t.TgZ(9,"th",10),t._uU(10,"\u0e9b\u0eb0\u0e95\u0eb4\u0e9a\u0eb1\u0e94\u0ec4\u0e94\u0ec9 "),t._UZ(11,"br"),t._uU(12," \u0ec3\u0e99\u0ec0\u0e94\u0eb7\u0ead\u0e99"),t.qZA(),t.TgZ(13,"th",10),t._uU(14,"\u0e84\u0ea7\u0eb2\u0ea1\u0e84\u0eb7\u0e9a\u0edc\u0ec9\u0eb2 "),t._UZ(15,"br"),t._uU(16," \u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94"),t.qZA(),t.TgZ(17,"th",10),t._uU(18,"\u0ea7\u0ebd\u0e81\u0e84\u0ebb\u0e87\u0e84\u0ec9\u0eb2\u0e87"),t.qZA(),t.TgZ(19,"th",10),t._uU(20,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0 "),t._UZ(21,"br"),t._uU(22," \u0e84\u0ea7\u0eb2\u0ea1\u0e84\u0eb7\u0e9a\u0edc\u0ec9\u0eb2 "),t.qZA()())}function K(n,i){if(1&n&&(t.TgZ(0,"tr")(1,"td",11),t._UZ(2,"button",12),t.qZA(),t.TgZ(3,"td",13)(4,"div",14),t._uU(5),t.qZA()(),t.TgZ(6,"td",10),t._UZ(7,"p-badge",15),t.qZA(),t.TgZ(8,"td",10),t._UZ(9,"p-badge",16),t.qZA(),t.TgZ(10,"td",10),t._UZ(11,"p-badge",17),t.qZA(),t.TgZ(12,"td",10),t._UZ(13,"p-badge",18),t.qZA(),t.TgZ(14,"td",10),t._UZ(15,"p-badge",19),t.qZA(),t.TgZ(16,"td")(17,"div"),t._UZ(18,"p-progressBar",20),t.qZA()()()),2&n){const e=i.$implicit,o=i.expanded,l=i.rowIndex,r=t.oxw(2);t.xp6(2),t.Q6J("pRowToggler",e)("icon",o?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(1),t.Q6J("pTooltip",(null==e||null==e.subject?null:e.subject.length)>25?null==e?null:e.subject:null),t.xp6(2),t.AsE(" ",l+1,"). ",null==e?null:e.subject," "),t.xp6(2),t.Q6J("value",r.utilService.formatNumber(null==e?null:e.weight)+"%"),t.xp6(2),t.Q6J("value",r.utilService.formatNumber(null==e?null:e.planInMonth)+"%"),t.xp6(2),t.Q6J("value",r.utilService.formatNumber(null==e?null:e.actualInMonth)+"%"),t.xp6(2),t.Q6J("value",r.utilService.formatNumber(null==e?null:e.totalProgress)+"%"),t.xp6(2),t.Q6J("value",r.utilService.formatNumber(null==e?null:e.totalPending)+"%"),t.xp6(3),t.Q6J("value",r.progressbarCalc(null==e?null:e.weight,null==e?null:e.totalProgress))}}function W(n,i){1&n&&(t.TgZ(0,"tr")(1,"th",24),t._uU(2,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(3,"th",10),t._uU(4,"\u0e99\u0ec9\u0eb3\u0edc\u0eb1\u0e81"),t.qZA(),t.TgZ(5,"th",10),t._uU(6,"\u0ec1\u0e9c\u0e99\u0ec0\u0ea5\u0eb5\u0ec8\u0ea1"),t.qZA(),t.TgZ(7,"th",10),t._uU(8,"\u0ec1\u0e9c\u0e99\u0eaa\u0eb3\u0ec0\u0ea5\u0eb1\u0e94"),t.qZA(),t.TgZ(9,"th",10),t._uU(10,"\u0e88\u0eb3\u0e99\u0ea7\u0e99 "),t._UZ(11,"br"),t._uU(12," \u0ec0\u0e94\u0eb7\u0ead\u0e99"),t.qZA(),t.TgZ(13,"th",10),t._uU(14,"\u0ec1\u0e9c\u0e99 "),t._UZ(15,"br"),t._uU(16," \u0ec3\u0e99\u0ec0\u0e94\u0eb7\u0ead\u0e99"),t.qZA(),t.TgZ(17,"th",10),t._uU(18,"\u0e9b\u0eb0\u0e95\u0eb4\u0e9a\u0eb1\u0e94\u0ec4\u0e94\u0ec9 "),t._UZ(19,"br"),t._uU(20," \u0ec3\u0e99\u0ec0\u0e94\u0eb7\u0ead\u0e99"),t.qZA(),t.TgZ(21,"th",10),t._uU(22,"\u0e84\u0eb0\u0ec1\u0e99\u0e99 "),t._UZ(23,"br"),t._uU(24," \u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99"),t.qZA(),t.TgZ(25,"th",10),t._uU(26," \u0e84\u0ea7\u0eb2\u0ea1\u0e84\u0eb7\u0e9a\u0edc\u0ec9\u0eb2 "),t._UZ(27,"br"),t._uU(28," \u0e97\u0eb5\u0ec8\u0e9c\u0ec8\u0eb2\u0e99\u0ea1\u0eb2 "),t.qZA(),t.TgZ(29,"th",10),t._uU(30," \u0e84\u0ea7\u0eb2\u0ea1\u0e84\u0eb7\u0e9a\u0edc\u0ec9\u0eb2 "),t._UZ(31,"br"),t._uU(32,"\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 "),t.qZA()())}function X(n,i){if(1&n&&(t.TgZ(0,"tr")(1,"td",25)(2,"div",26),t._uU(3),t.qZA()(),t.TgZ(4,"td",27),t._uU(5),t.qZA(),t.TgZ(6,"td",27),t._uU(7),t.ALo(8,"date"),t.qZA(),t.TgZ(9,"td",27),t._uU(10),t.ALo(11,"date"),t.qZA(),t.TgZ(12,"td",27),t._uU(13),t.ALo(14,"number"),t.qZA(),t.TgZ(15,"td",27),t._uU(16),t.ALo(17,"number"),t.qZA(),t.TgZ(18,"td",27),t._uU(19),t.ALo(20,"number"),t.qZA(),t.TgZ(21,"td",27),t._uU(22),t.ALo(23,"number"),t.qZA(),t.TgZ(24,"td",27),t._uU(25),t.ALo(26,"number"),t.qZA(),t.TgZ(27,"td",28),t._uU(28),t.ALo(29,"number"),t.qZA()()),2&n){const e=i.$implicit,o=i.rowIndex;t.xp6(1),t.Q6J("pTooltip",(null==e||null==e.subject?null:e.subject.length)>15?null==e?null:e.subject:null),t.xp6(2),t.AsE(" ",o+1,".",null==e?null:e.subject," "),t.xp6(2),t.hij("",null==e?null:e.weight,"%"),t.xp6(2),t.Oqu(t.xi3(8,12,null==e?null:e.scheduledStart,"dd/MM/yyyy")),t.xp6(3),t.Oqu(t.xi3(11,15,null==e?null:e.scheduledEnd,"dd/MM/yyyy")),t.xp6(3),t.Oqu(t.xi3(14,18,null==e?null:e.totalMonth,"1.2-2")),t.xp6(3),t.hij("",t.xi3(17,21,null==e?null:e.planAvgMonth,"1.2-2"),"%"),t.xp6(3),t.hij("",t.xi3(20,24,null==e?null:e.planInMonth,"1.2-2"),"%"),t.xp6(3),t.Oqu(t.xi3(23,27,null==e?null:e.evaluationScore,"1.2-2")),t.xp6(3),t.hij("",t.xi3(26,30,null==e?null:e.progressPrevious,"1.2-2"),"%"),t.xp6(3),t.hij("",t.xi3(29,33,null==e?null:e.progressAll,"1.2-2"),"%")}}function tt(n,i){if(1&n&&(t.TgZ(0,"tr")(1,"td",29),t._uU(2,"\u0ea5\u0ea7\u0ea1\u0e8d\u0ec8\u0ead\u0e8d:"),t.qZA(),t.TgZ(3,"td",28),t._uU(4),t.qZA(),t._UZ(5,"td")(6,"td"),t.TgZ(7,"td",28),t._uU(8),t.qZA(),t.TgZ(9,"td",28),t._uU(10),t.qZA(),t.TgZ(11,"td",28),t._uU(12),t.qZA(),t.TgZ(13,"td",28),t._uU(14),t.qZA(),t.TgZ(15,"td",28),t._uU(16),t.qZA(),t.TgZ(17,"td",28),t._uU(18),t.qZA()()),2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(4),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"weight"),"% "),t.xp6(4),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"totalMonth")," "),t.xp6(2),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"planAvgMonth"),"% "),t.xp6(2),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"planInMonth"),"% "),t.xp6(2),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"evaluationScore")," "),t.xp6(2),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"progressPrevious"),"% "),t.xp6(2),t.hij(" ",o.reportHelpService.totalByPlanSub(null==e?null:e.planMainId,null==e?null:e.planSubs,"progressAll"),"% ")}}function et(n,i){if(1&n&&(t.TgZ(0,"tr")(1,"td",21)(2,"div",22)(3,"p-table",23),t.YNc(4,W,33,0,"ng-template",2),t.YNc(5,X,30,36,"ng-template",4),t.YNc(6,tt,19,7,"ng-template",6),t.qZA()()()()),2&n){const e=i.$implicit;t.xp6(3),t.Q6J("value",null==e?null:e.planSubs)}}function nt(n,i){if(1&n&&(t.TgZ(0,"tr",30)(1,"td",29),t._uU(2,"\u0ea5\u0ea7\u0ea1:"),t.qZA(),t.TgZ(3,"td",28),t._uU(4),t.qZA(),t.TgZ(5,"td",28),t._uU(6),t.qZA(),t.TgZ(7,"td",28),t._uU(8),t.qZA(),t.TgZ(9,"td",28),t._uU(10),t.qZA(),t.TgZ(11,"td",28),t._uU(12),t.qZA(),t._UZ(13,"td"),t.qZA(),t.TgZ(14,"tr",30)(15,"td",29),t._uU(16,"\u0ea5\u0ea7\u0ea1\u0e84\u0eb0\u0ec1\u0e99\u0e99\u0e95\u0eb2\u0ea1\u0eaa\u0eb1\u0e94\u0eaa\u0ec8\u0ea7\u0e99 (60/100):"),t.qZA(),t.TgZ(17,"td",28),t._uU(18),t.ALo(19,"number"),t.qZA(),t._UZ(20,"td")(21,"td")(22,"td")(23,"td")(24,"td"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(4),t.hij(" ",e.totalWeight,"% "),t.xp6(2),t.hij(" ",e.totalPlanInMonth,"% "),t.xp6(2),t.hij(" ",e.totalActualInMonth,"% "),t.xp6(2),t.hij(" ",e.totalProgress,"% "),t.xp6(2),t.hij(" ",e.totalPending,"% "),t.xp6(6),t.hij(" ",t.xi3(19,6,e.totalActualScore,"1.2-2")," ")}}function ot(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"p-fieldset",1),t.YNc(2,O,3,0,"ng-template",2),t.TgZ(3,"p-table",3),t.YNc(4,V,23,0,"ng-template",2),t.YNc(5,K,19,11,"ng-template",4),t.YNc(6,et,7,1,"ng-template",5),t.YNc(7,nt,25,9,"ng-template",6),t.qZA()(),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("toggleable",!0),t.xp6(2),t.Q6J("value",e.reportItems)("scrollable",!0)("scrollHeight",e.screenHeight+"px")("showCurrentPageReport",!0)}}let it=(()=>{class n{constructor(e,o,l,r,c,E){this.mainSumService=e,this.cdr=o,this.filter=l,this.menuService=r,this.utilService=c,this.reportHelpService=E,this.dataEmitter=new t.vpe,this.reportItems=[],this.totalWeight=0,this.totalPlanInMonth=0,this.totalActualInMonth=0,this.totalProgress=0,this.totalPending=0,this.totalScore=0,this.totalActualScore=0,this.screenHeight=0,this.filterFields=["name","description"],this.showMenu$=this.menuService.menuState$,this.destroy$=new d.x}ngOnInit(){this.mainSumService.items$.pipe((0,S.R)(this.destroy$)).subscribe(e=>{this.reportItems=e,this.summary(e),this.cdr.markForCheck()}),this.checkScreenSize()}onResize(e){this.checkScreenSize()}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}progressbarCalc(e,o){if(e<=0||o<=0)return 0;const l=Math.min(100,o/e*100);return parseFloat(l.toFixed(2))}summary(e){e&&0!==e.length?(this.totalWeight=this.reportHelpService.totalByPlanMain(e,"weight"),this.totalPlanInMonth=this.reportHelpService.totalByPlanMain(e,"planInMonth"),this.totalActualInMonth=this.reportHelpService.totalByPlanMain(e,"actualInMonth"),this.totalProgress=this.reportHelpService.totalByPlanMain(e,"totalProgress"),this.totalPending=this.reportHelpService.totalByPlanMain(e,"totalPending"),this.totalScore=Math.min(100*this.totalActualInMonth/this.totalPlanInMonth,100),this.totalActualScore=Math.min(60*this.totalScore/100,100),this.sendDataToParent(this.totalActualScore)):this.sendDataToParent(0)}sendDataToParent(e){this.dataEmitter.emit({totalScore:e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(J.Q),t.Y36(t.sBO),t.Y36(T.i),t.Y36(B.h),t.Y36(x.F),t.Y36(j.Z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-eval-task-plan"]],hostBindings:function(e,o){1&e&&t.NdJ("resize",function(r){return o.onResize(r)},!1,t.Jf7)},outputs:{dataEmitter:"dataEmitter"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"toggleable"],["pTemplate","header"],["dataKey","id","styleClass","p-datatable-sm","responsiveLayout","scroll",3,"value","scrollable","scrollHeight","showCurrentPageReport"],["pTemplate","body"],["pTemplate","rowexpansion"],["pTemplate","footer"],[1,"flex","align-items-center"],[1,"font-semibold","text-xl"],["colspan","2",1,"white-space-nowrap","text-lg"],[1,"text-center","white-space-nowrap"],[1,"text-center","white-space-nowrap",2,"width","4rem"],["type","button","pButton","","pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"pRowToggler","icon"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"max-w-10rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis","text-lg"],["severity","warning","size","large",3,"value"],["severity","info","size","large",3,"value"],["severity","success","size","large",3,"value"],["size","large",3,"value"],["severity","danger","size","large",3,"value"],[3,"value"],["colspan","8"],[1,"px-3","py-2"],["dataKey","id","rowGroupMode","rowspan","groupRowsBy","division.name","styleClass","p-datatable-sm p-datatable-gridlines",3,"value"],["colspan","2"],["colspan","2","tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"max-w-10rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[1,"text-center"],[1,"text-center","font-bold"],["colspan","2",1,"text-right","font-bold"],[1,"text-xl"]],template:function(e,o){1&e&&t.YNc(0,ot,8,5,"ng-container",0),2&e&&t.Q6J("ngIf",o.reportItems&&(null==o.reportItems?null:o.reportItems.length))},dependencies:[p.O5,b.p,v.jx,f.iA,f.jB,D.u,h.Hq,A.Ct,k.k,p.JJ,p.uU],encapsulation:2}),n})();var N=u(1042);function ut(n,i){1&n&&(t.TgZ(0,"div",7)(1,"span",8),t._uU(2,"\u0e9c\u0ebb\u0e99\u0e81\u0eb2\u0e99\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0ea7\u0ebd\u0e81\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d"),t.qZA()())}function lt(n,i){1&n&&(t.TgZ(0,"tr")(1,"th",9),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",10),t._uU(4," \u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81 "),t.qZA(),t.TgZ(5,"th",11),t._uU(6," \u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0 "),t.qZA(),t.TgZ(7,"th",12),t._uU(8," \u0ea5\u0ea7\u0ea1\u0e84\u0eb0\u0ec1\u0e99\u0e99\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99 "),t.qZA()())}const rt=function(n){return{color:n}};function st(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",17),t._UZ(2,"i"),t.TgZ(3,"span",18),t._uU(4),t.qZA()(),t.BQk()),2&n){const e=i.ngIf;t.xp6(1),t.Akn(t.VKq(5,rt,null==e?null:e.color)),t.xp6(1),t.Tol(null==e?null:e.icon),t.xp6(2),t.Oqu(null==e?null:e.name)}}const at=function(){return{width:"50px"}};function pt(n,i){if(1&n&&(t.TgZ(0,"tr")(1,"td",13),t._uU(2),t.qZA(),t.TgZ(3,"td",14)(4,"div",15),t._uU(5),t.qZA()(),t.TgZ(6,"td"),t.YNc(7,st,5,7,"ng-container",0),t.qZA(),t.TgZ(8,"td",12),t._UZ(9,"p-badge",16),t.qZA()()),2&n){const e=i.$implicit,o=i.rowIndex,l=t.oxw(2);t.xp6(1),t.Q6J("ngStyle",t.DdM(6,at)),t.xp6(1),t.hij(" ",o+1," "),t.xp6(1),t.Q6J("pTooltip",(null==e||null==e.subject?null:e.subject.length)>25?null==e?null:e.subject:null),t.xp6(2),t.hij(" ",null==e?null:e.subject," "),t.xp6(2),t.Q6J("ngIf",null==e?null:e.status),t.xp6(2),t.Q6J("value",l.utilService.formatNumber(null==e?null:e.totalEvalScore))}}function ct(n,i){if(1&n&&(t.TgZ(0,"tr",19)(1,"td",20),t._uU(2,"\u0ea5\u0ea7\u0ea1\u0e84\u0eb0\u0ec1\u0e99\u0e99 (\u0ec0\u0e95\u0eb1\u0ea1 85%):"),t.qZA(),t.TgZ(3,"td",21),t._uU(4),t.ALo(5,"number"),t.qZA()(),t.TgZ(6,"tr",19)(7,"td",20),t._uU(8,"\u0ea5\u0ea7\u0ea1\u0e84\u0eb0\u0ec1\u0e99\u0e99\u0e95\u0eb2\u0ea1\u0eaa\u0eb1\u0e94\u0eaa\u0ec8\u0ea7\u0e99 (40/100):"),t.qZA(),t.TgZ(9,"td",21),t._uU(10),t.ALo(11,"number"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(4),t.hij(" ",t.xi3(5,2,e.totalAverage,"1.2-2")," "),t.xp6(6),t.hij(" ",t.xi3(11,5,e.totalActualScore,"1.2-2")," ")}}function Et(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"p-fieldset",1),t.YNc(2,ut,3,0,"ng-template",2),t.TgZ(3,"p-table",3,4),t.YNc(5,lt,9,0,"ng-template",2),t.YNc(6,pt,10,7,"ng-template",5),t.YNc(7,ct,12,8,"ng-template",6),t.qZA()(),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("toggleable",!0),t.xp6(2),t.Q6J("value",e.reportItems)("scrollable",!0)("scrollHeight",e.screenHeight+"px")("rowHover",!0)}}let dt=(()=>{class n{constructor(e,o,l,r,c,E){this.taskAssignSumService=e,this.cdr=o,this.filter=l,this.menuService=r,this.utilService=c,this.reportHelpService=E,this.dataEmitter=new t.vpe,this.reportItems=[],this.totalAverage=0,this.totalActualScore=0,this.screenHeight=0,this.showMenu$=this.menuService.menuState$,this.destroy$=new d.x}ngOnInit(){this.taskAssignSumService.items$.pipe((0,S.R)(this.destroy$)).subscribe(e=>{this.reportItems=e,this.getAverage(e),this.cdr.markForCheck()}),this.checkScreenSize()}onResize(e){this.checkScreenSize()}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}getAverage(e){e&&e.length?(this.totalAverage=this.reportHelpService.averageByProperty(e,"totalEvalScore"),this.totalActualScore=40*this.totalAverage/85,this.sendDataToParent(this.totalActualScore)):this.sendDataToParent(0)}sendDataToParent(e){this.dataEmitter.emit({totalScore:e})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(N.j),t.Y36(t.sBO),t.Y36(T.i),t.Y36(B.h),t.Y36(x.F),t.Y36(j.Z))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-eval-task-assign"]],hostBindings:function(e,o){1&e&&t.NdJ("resize",function(r){return o.onResize(r)},!1,t.Jf7)},outputs:{dataEmitter:"dataEmitter"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"toggleable"],["pTemplate","header"],["responsiveLayout","scroll","dataKey","id","styleClass","p-datatable-sm",3,"value","scrollable","scrollHeight","rowHover"],["dt",""],["pTemplate","body"],["pTemplate","footer"],[1,"flex","align-items-center"],[1,"font-semibold","text-xl"],[1,"text-center"],[1,"white-space-nowrap","text-lg"],[1,"white-space-nowrap"],[1,"text-center","white-space-nowrap"],[1,"text-center",3,"ngStyle"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"max-w-10rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],["severity","success","size","large",3,"value"],[1,"font-semibold"],[1,"ml-1"],[1,"text-xl"],["colspan","3",1,"text-right","font-bold"],[1,"text-center","font-bold"]],template:function(e,o){1&e&&t.YNc(0,Et,8,5,"ng-container",0),2&e&&t.Q6J("ngIf",o.reportItems&&(null==o.reportItems?null:o.reportItems.length))},dependencies:[p.O5,p.PC,b.p,v.jx,f.iA,D.u,A.Ct,p.JJ],encapsulation:2,changeDetection:0}),n})();var mt=u(2569),gt=u(5143);function ht(n,i){if(1&n&&(t.TgZ(0,"div",5)(1,"div"),t._uU(2),t.qZA()()),2&n){const e=i.$implicit;t.xp6(2),t.AsE("[",null==e?null:e.code,"]-",null==e?null:e.name,"")}}function vt(n,i){if(1&n&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&n){const e=i.$implicit;t.xp6(1),t.AsE("[",null==e?null:e.code,"]-",null==e?null:e.name,"")}}const At=function(){return{width:"150px"}},ft=function(){return{width:"250px"}};let Zt=(()=>{class n{constructor(e,o,l,r,c,E,U){this.parentForm=e,this.cdr=o,this.loadingService=l,this.divisionService=r,this.userService=c,this.planMainSumService=E,this.taskAssignSumService=U,this.divisions=[],this.months=[],this.loading$=this.loadingService.state$,this.destroy$=new d.x}get control(){return this.formGroup.get("divisionId")}ngOnInit(){this.months=[{name:"11",code:"11"},{name:"10",code:"10"}],this.formGroup=this.parentForm.control,this.user=this.userService.getLoggedUser(),this.getAllDivisions(),this.divisionService.items$.pipe((0,S.R)(this.destroy$)).subscribe(e=>{this.divisions=e,this.cdr.markForCheck()})}onChangeMonth(){this.formGroup.patchValue({divisionId:null})}getAllDivisions(){const e=this.user?.profile?.department?.id,o=Object.assign({departmentId:e,isBranch:!0});this.divisionService.getAll(o).subscribe()}onChange(e){if(e){const o={...this.formGroup.value};this.planMainSumService.getAllByDiv(o).subscribe(),this.taskAssignSumService.getAllByDiv(o).subscribe()}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.sg),t.Y36(t.sBO),t.Y36(mt.b),t.Y36(gt.E),t.Y36(P.K),t.Y36(J.Q),t.Y36(N.j))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-dropdown-division"]],decls:6,vars:14,consts:[[3,"formGroup"],["optionLabel","\u0ec0\u0e94\u0eb7\u0ead\u0e99","placeholder","\u0ec0\u0ea5\u0eb7\u0ead\u0e81\u0ec0\u0e94\u0eb7\u0ead\u0e99","optionValue","code","optionLabel","name","formControlName","batchMonth",3,"options","onChange"],["appendTo","body","id","divisionId","optionValue","id","optionLabel","name","emptyFilterMessage","\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99","placeholder","\u0ec0\u0ea5\u0eb7\u0ead\u0e81\u0eaa\u0eb2\u0e82\u0eb2","styleClass","w-25rem ml-2","formControlName","divisionId",3,"options","filter","resetFilterOnHide","emptyMessage","onFocus","onChange"],["pTemplate","selectedItem"],["pTemplate","item"],[1,"flex","align-items-center"]],template:function(e,o){1&e&&(t.TgZ(0,"form",0)(1,"p-dropdown",1),t.NdJ("onChange",function(){return o.onChangeMonth()}),t.qZA(),t.TgZ(2,"p-dropdown",2),t.NdJ("onFocus",function(){return o.getAllDivisions()})("onChange",function(r){return o.onChange(r.value)}),t.ALo(3,"async"),t.YNc(4,ht,3,2,"ng-template",3),t.YNc(5,vt,2,2,"ng-template",4),t.qZA()()),2&e&&(t.Q6J("formGroup",o.formGroup),t.xp6(1),t.Akn(t.DdM(12,At)),t.Q6J("options",o.months),t.xp6(1),t.Akn(t.DdM(13,ft)),t.Q6J("options",o.divisions)("filter",!0)("resetFilterOnHide",!0)("emptyMessage",t.lcZ(3,10,o.loading$)?"\u0e81\u0eb3\u0ea5\u0eb1\u0e87\u0ec2\u0eab\u0ebc\u0e94..":"\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99"))},dependencies:[s._Y,s.JJ,s.JL,s.sg,s.u,a.bc,a.VP,a.YE,v.jx,_.Lt,p.Ov],encapsulation:2,changeDetection:0}),n})();function Ct(n,i){if(1&n&&(t.ynx(0),t.TgZ(1,"div",12)(2,"div",13)(3,"span",14),t._uU(4,"\u0e9c\u0ebb\u0e99\u0ea5\u0ea7\u0ea1\u0e84\u0eb0\u0ec1\u0e99\u0e99:"),t.qZA(),t._UZ(5,"p-badge",15),t.qZA(),t.TgZ(6,"div",16)(7,"span"),t._uU(8,"\u0ec0\u0e81\u0ea3\u0e94\u0e97\u0eb5\u0ec8\u0ec4\u0e94\u0ec9\u0eae\u0eb1\u0e9a: "),t.TgZ(9,"span",17),t._uU(10),t.qZA()()()(),t.BQk()),2&n){const e=t.oxw();t.xp6(5),t.Q6J("value",e.totalCombinedScore.toString()),t.xp6(5),t.hij(" ",e.gradeService.getGrade(e.totalCombinedScore)," ")}}const _t=[{path:"",component:(()=>{class n{constructor(e,o,l,r,c,E,U,Dt,Ut,yt,wt){this.filter=e,this.menuService=o,this.utilService=l,this.gradeService=r,this.confirmService=c,this.dialogRef=E,this.dialogService=U,this.fb=Dt,this.approveService=Ut,this.alertService=yt,this.userService=wt,this.reportItems=[],this.totalPlanScore=0,this.totalAssignScore=0,this.totalCombinedScore=0,this.screenHeight=0,this.showMenu$=this.menuService.menuState$,this.destroy$=new d.x,this.formGroup=this.fb.formGroup(new Z)}get controls(){return this.formGroup.controls}ngOnInit(){this.user=this.userService.getLoggedUser(),this.deptId=this.user?.profile?.department?.id}getEmitterTaskPlan(e){e.totalScore&&(this.totalPlanScore=e.totalScore,this.calculateCombinedScore())}getEmitterTaskAssign(e){e.totalScore&&(this.totalAssignScore=e.totalScore,this.calculateCombinedScore())}calculateCombinedScore(){const e=this.totalPlanScore+this.totalAssignScore;e&&(this.totalCombinedScore=parseFloat(e.toFixed(2)),this.gradeSys=this.gradeService.getGrade(this.totalCombinedScore))}onApprove(){this.confirmService.confirm({message:"\u0e97\u0ec8\u0eb2\u0e99\u0ec1\u0e99\u0ec8\u0ec3\u0e88\u0e9a\u0ecd\u0ec8\u0ea7\u0ec8\u0eb2\u0ec0\u0eab\u0eb1\u0e99\u0e94\u0eb5\u0e95\u0eb2\u0ea1\u0e9c\u0ebb\u0e99\u0e81\u0eb2\u0e99\u0e9b\u0eb0\u0ec0\u0ea1\u0eb5\u0e99\u0e99\u0eb5\u0ec9 ?",icon:"pi pi-exclamation-triangle",accept:()=>{this.execApprove()}})}execApprove(){const e=this.formGroup.value;this.formGroup.disable();const o={departmentId:this.deptId,...e,gradeScore:this.totalCombinedScore,gradeSys:this.gradeSys};this.approveService.create(o).subscribe({next:l=>{l&&(this.resetData(),this.alertService.showSuccess("\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99\u0ec1\u0ea5\u0ec9\u0ea7"))},error:l=>{this.formGroup.enable(),this.alertService.showError(l)}})}onNotApproved(){this.dialogRef=this.dialogService.open(R,{header:"\u0e81\u0eb0\u0ea5\u0eb8\u0e99\u0eb2\u0ec0\u0ea5\u0eb7\u0ead\u0e81\u0ec0\u0e81\u0ea3\u0e94\u0e97\u0eb5\u0ec8\u0ec0\u0eab\u0eb1\u0e99\u0ea7\u0ec8\u0eb2\u0ec0\u0edd\u0eb2\u0eb0\u0eaa\u0ebb\u0ea1",data:{data:{batchMonth:this.controls.batchMonth.value,departmentId:this.deptId,divisionId:this.controls.divisionId.value,gradeScore:this.totalCombinedScore,gradeSys:this.gradeSys}},width:"50%",contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,dismissableMask:!1})}resetData(){this.formGroup.enable(),this.formGroup.markAsPristine()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef&&this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(T.i),t.Y36(B.h),t.Y36(x.F),t.Y36(z.U),t.Y36(v.YP),t.Y36(g.E7),t.Y36(g.xA),t.Y36(a.GW),t.Y36(I),t.Y36(M.c),t.Y36(P.K))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-appr-division"]],features:[t._Bn([p.JJ])],decls:15,vars:2,consts:[[1,"p-grid"],["styleClass","card my-4"],[1,"p-toolbar-group-start","text-2xl"],[3,"formGroup"],[1,"flex","align-items-center"],[1,"p-toolbar-group-end"],["pButton","","pRipple","","icon","pi pi-check","label","\u0ead\u0eb0\u0e99\u0eb8\u0ea1\u0eb1\u0e94",1,"p-button-success","text-lg","font-semibold","mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-times","label","\u0e9e\u0eb4\u0e88\u0eb2\u0ea5\u0eb0\u0e99\u0eb2\u0e84\u0eb7\u0e99",1,"p-button-danger","text-lg","font-semibold",3,"click"],[1,"p-col-12"],[4,"ngIf"],[3,"dataEmitter"],[1,"mt-4"],[1,"flex","align-items-center","justify-content-center","gap-3"],[1,"white-space-nowrap","text-2xl","font-semibold"],[1,"mr-2"],["severity","success","size","large",3,"value"],[1,"white-space-nowrap","font-semibold","text-2xl"],[1,"text-3xl","font-bold"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"p-toolbar",1)(2,"div",2)(3,"form",3)(4,"div",4),t._UZ(5,"app-dropdown-division"),t.qZA()()(),t.TgZ(6,"div",5)(7,"button",6),t.NdJ("click",function(){return o.onApprove()}),t.qZA(),t.TgZ(8,"button",7),t.NdJ("click",function(){return o.onNotApproved()}),t.qZA()()(),t.TgZ(9,"div",8),t.YNc(10,Ct,11,2,"ng-container",9),t.TgZ(11,"div")(12,"app-eval-task-plan",10),t.NdJ("dataEmitter",function(r){return o.getEmitterTaskPlan(r)}),t.qZA()(),t.TgZ(13,"div",11)(14,"app-eval-task-assign",10),t.NdJ("dataEmitter",function(r){return o.getEmitterTaskAssign(r)}),t.qZA()()()()),2&e&&(t.xp6(3),t.Q6J("formGroup",o.formGroup),t.xp6(7),t.Q6J("ngIf",o.controls.divisionId.value))},dependencies:[p.O5,s._Y,s.JL,s.sg,a.VP,Y.o,h.Hq,A.Ct,it,dt,Zt],encapsulation:2}),n})()}];let Tt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[w.Bz.forChild(_t),w.Bz]}),n})();var Bt=u(2137),xt=u(1493),St=u(4466);let bt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[p.ez,Tt,St.m,Y.V,b.L,f.U$,xt.S,_.kW,q.A,D.z,h.hJ,A.TX,k.q,Bt.D]}),n})()}}]);