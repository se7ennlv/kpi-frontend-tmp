"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[8838],{8838:(En,d,i)=>{i.r(d),i.d(d,{PlanSubOutBranchModule:()=>dn});var c=i(6895),g=i(5675),Z=i(7579),b=i(2722),m=i(3033),n=i(8274),r=i(4325),f=i(3948);function C(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"div"),n._UZ(2,"i",4),n.TgZ(3,"span"),n._uU(4),n.qZA()(),n.BQk()),2&e){const t=o.ngIf;n.xp6(4),n.Oqu(t.name)}}function w(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"tr")(2,"td"),n.YNc(3,C,5,1,"ng-container",0),n.qZA(),n.TgZ(4,"td")(5,"div",2),n._uU(6," ("),n._UZ(7,"app-task-status",3),n._uU(8,") "),n.qZA()()(),n.BQk()),2&e){const t=o.$implicit;n.xp6(3),n.Q6J("ngIf",t.office),n.xp6(4),n.Q6J("taskStatus",t.status)}}function y(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"table")(2,"tbody"),n.YNc(3,w,9,2,"ng-container",1),n.qZA()(),n.BQk()),2&e){const t=n.oxw();n.xp6(3),n.Q6J("ngForOf",t.workflows)("ngForTrackBy",t.trackByFn)}}let O=(()=>{class e{constructor(t){this.dialogConfig=t,this.workflows=[]}ngOnInit(){this.workflows=this.dialogConfig.data.data}trackByFn(t,u){return u.id||t}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(r.S))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-task-wf-office"]],inputs:{workflows:"workflows"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"ml-2"],[3,"taskStatus"],[1,"pi","pi-user","mr-2"]],template:function(t,u){1&t&&n.YNc(0,y,4,2,"ng-container",0),2&t&&n.Q6J("ngIf",u.workflows&&u.workflows.length)},dependencies:[c.sg,c.O5,f.h],encapsulation:2}),e})();var k=i(209),P=i(6832),Q=i(8145),M=i(1094),E=i(3119),h=i(8386),p=i(793),D=i(805),_=i(6679),B=i(7147),v=i(3608),x=i(8271),T=i(8558),A=i(5593),I=i(6993),U=i(2300);function J(e,o){if(1&e){const t=n.EpF();n.TgZ(0,"div")(1,"p-button",9),n.NdJ("click",function(){n.CHM(t);const l=n.oxw();return n.KtG(l.menuService.showMenu())}),n.qZA()()}}function F(e,o){if(1&e){const t=n.EpF();n.TgZ(0,"div")(1,"p-button",10),n.NdJ("click",function(){n.CHM(t);const l=n.oxw();return n.KtG(l.menuService.hideMenu())}),n.qZA()()}}function Y(e,o){if(1&e&&(n.TgZ(0,"tr")(1,"td",11),n._UZ(2,"button",12),n.qZA(),n.TgZ(3,"td",13)(4,"div",14)(5,"span",15),n._uU(6,"\u0ea7\u0ebd\u0e81\u0eab\u0ebc\u0eb1\u0e81:"),n.qZA(),n.TgZ(7,"span",16),n._uU(8),n.qZA()()(),n.TgZ(9,"td",17)(10,"div",18),n._UZ(11,"app-plan-main-action",19),n.qZA()()()),2&e){const t=o.$implicit,u=o.expanded,l=n.oxw();n.xp6(2),n.Q6J("pRowToggler",t)("icon",u?"pi pi-chevron-down":"pi pi-chevron-right"),n.xp6(1),n.Q6J("pTooltip",l.utilService.getTooltip(null==t||null==t.planMain?null:t.planMain.subject,25)),n.xp6(5),n.AsE("#",null==t||null==t.planMain?null:t.planMain.id,"-",null==t||null==t.planMain?null:t.planMain.subject,""),n.xp6(3),n.Q6J("workflowId",null==t?null:t.id)("task",null==t?null:t.planMain)("isBranch",!0)}}function R(e,o){1&e&&(n.TgZ(0,"tr")(1,"th"),n._uU(2,"#"),n.qZA(),n.TgZ(3,"th",25),n._uU(4,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),n.qZA(),n.TgZ(5,"th"),n._uU(6,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),n.qZA(),n.TgZ(7,"th",25),n._uU(8,"\u0e99\u0ec9\u0eb3\u0edc\u0eb1\u0e81 (%)"),n.qZA(),n.TgZ(9,"th",25),n._uU(10,"\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),n.qZA(),n.TgZ(11,"th",25),n._uU(12,"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9"),n.qZA(),n.TgZ(13,"th",25),n._uU(14,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0"),n.qZA(),n.TgZ(15,"th",25),n._uU(16,"\u0e94\u0eb3\u0ec0\u0e99\u0eb5\u0e99\u0e81\u0eb2\u0e99"),n.qZA()())}function N(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"p-chip",35)(2,"div",36),n._uU(3,"\u0ec0\u0ea7\u0ea5\u0eb2"),n.qZA()(),n.BQk()),2&e){const t=n.oxw().$implicit,u=n.oxw(2);n.xp6(1),n.Q6J("pTooltip",u.utilService.dateTimeShortFormat(null==t?null:t.indicatorTime))}}function $(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"p-chip",35)(2,"div",36),n._uU(3,"\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),n.qZA()(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(1),n.Q6J("pTooltip",null==t?null:t.indicatorQuantity)}}function j(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"p-chip",35)(2,"div",36),n._uU(3,"\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),n.qZA()(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(1),n.Q6J("pTooltip",null==t||null==t.indicatorQuality?null:t.indicatorQuality.subject)}}function W(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"p-chip",35)(2,"div",36),n._uU(3,"\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),n.qZA()(),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(1),n.Q6J("pTooltip",null==t||null==t.indicatorSatisfied?null:t.indicatorSatisfied.subject)}}const q=function(){return{"background-color":"#dee2e6"}};function z(e,o){if(1&e&&(n.ynx(0),n._UZ(1,"p-avatar",38),n.BQk()),2&e){const t=n.oxw().$implicit;n.xp6(1),n.Akn(n.DdM(4,q)),n.Q6J("pTooltip",null==t||null==t.office?null:t.office.name)("label",null==t||null==t.office?null:t.office.name.charAt(0))}}function H(e,o){if(1&e&&(n.ynx(0),n.YNc(1,z,2,5,"ng-container",4),n.BQk()),2&e){const t=o.index;n.xp6(1),n.Q6J("ngIf",t<2)}}function K(e,o){1&e&&(n.TgZ(0,"span"),n._uU(1,"..."),n.qZA())}function G(e,o){if(1&e&&(n.ynx(0),n.TgZ(1,"p-avatarGroup"),n.YNc(2,H,2,1,"ng-container",37),n.YNc(3,K,2,0,"span",4),n.qZA(),n.BQk()),2&e){const t=o.ngIf,u=n.oxw(3);n.xp6(2),n.Q6J("ngForOf",t)("ngForTrackBy",u.trackByFn),n.xp6(1),n.Q6J("ngIf",t.length>2)}}const L=function(){return{width:"50px"}};function X(e,o){if(1&e){const t=n.EpF();n.TgZ(0,"tr")(1,"td"),n._uU(2),n.qZA(),n.TgZ(3,"td",26),n._uU(4),n.qZA(),n.TgZ(5,"td",27)(6,"div",28),n._uU(7),n.qZA()(),n.TgZ(8,"td",26),n._UZ(9,"p-tag",29),n.qZA(),n.TgZ(10,"td",30)(11,"div",31),n.YNc(12,N,4,1,"ng-container",4),n.YNc(13,$,4,1,"ng-container",4),n.YNc(14,j,4,1,"ng-container",4),n.YNc(15,W,4,1,"ng-container",4),n.qZA()(),n.TgZ(16,"td",25)(17,"div",32),n.NdJ("click",function(){const a=n.CHM(t).$implicit,s=n.oxw(2);return n.KtG(s.showAssignee(null==a?null:a.oworkflows))}),n.YNc(18,G,4,3,"ng-container",4),n.qZA()(),n.TgZ(19,"td",25),n._UZ(20,"app-task-status",33),n.qZA(),n.TgZ(21,"td",25),n._UZ(22,"app-plan-sub-action",34),n.qZA()()}if(2&e){const t=o.$implicit,u=o.rowIndex,l=n.oxw().$implicit;n.xp6(2),n.Oqu(u+1),n.xp6(2),n.hij(" ",null==t?null:t.id,""),n.xp6(1),n.Q6J("pTooltip",(null==l||null==l.subject?null:l.subject.length)>25?null==l?null:l.subject:null),n.xp6(2),n.hij(" ",null==t?null:t.subject," "),n.xp6(2),n.Akn(n.DdM(17,L)),n.Q6J("value",(null==t?null:t.weight)+"%")("rounded",!0),n.xp6(3),n.Q6J("ngIf",null==t?null:t.indicatorTime),n.xp6(1),n.Q6J("ngIf",null==t?null:t.indicatorQuantity),n.xp6(1),n.Q6J("ngIf",null==t||null==t.indicatorQuality?null:t.indicatorQuality.id),n.xp6(1),n.Q6J("ngIf",null==t||null==t.indicatorSatisfied?null:t.indicatorSatisfied.id),n.xp6(3),n.Q6J("ngIf",null==t?null:t.oworkflows),n.xp6(2),n.Q6J("taskStatus",null==t?null:t.status),n.xp6(2),n.Q6J("taskWfId",null==l?null:l.id)("taskMainId",null==l||null==l.planMain?null:l.planMain.id)("planSub",t)}}function V(e,o){1&e&&(n.TgZ(0,"tr")(1,"td",39),n._uU(2,"\u0e8d\u0eb1\u0e87\u0e9a\u0ecd\u0ec8\u0ea1\u0eb5\u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),n.qZA()())}function nn(e,o){if(1&e&&(n.TgZ(0,"tr")(1,"td",20)(2,"div",21)(3,"p-table",22),n.YNc(4,R,17,0,"ng-template",23),n.YNc(5,X,23,18,"ng-template",7),n.YNc(6,V,3,0,"ng-template",24),n.qZA()()()()),2&e){const t=o.$implicit;n.xp6(3),n.Q6J("value",null==t?null:t.planSubs)}}const tn=function(){return{"min-width":"50rem"}},en=function(){return[10,25,50]},on=function(){return{"min-width":"60rem"}},un=[{path:"",component:(()=>{class e{constructor(t,u,l,a,s,gn,mn,fn){this.filter=t,this.menuService=u,this.utilService=l,this.dialogService=a,this.mainWfService=s,this.cdr=gn,this.dialogRef=mn,this.userService=fn,this.workflows=[],this.planSubs=[],this.mainMenus=[],this.screenHeight=0,this.showMenu$=this.menuService.menuState$,this.destroy$=new Z.x}ngOnInit(){this.initUserData(),this.mainWfService.items$.pipe((0,b.R)(this.destroy$)).subscribe(t=>{this.workflows=t,this.cdr.markForCheck()}),this.checkScreenSize()}onResize(t){this.checkScreenSize()}showAssignee(t){this.dialogRef=this.dialogService.open(O,{header:"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9:",width:window.innerWidth>k.A.lg?"30%":"50%",data:{data:t},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4})}onRowExpand(t){const u=t?.data?.planMainId,a=m.e.getPlanSub({departmentId:this.departmentId,divisionId:this.divisionId,planMainId:u},!0);this.mainWfService.getManyPlanSub(u,a).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef&&this.dialogRef.close()}trackByFn(t,u){return u.id||t}initUserData(){this.user=this.userService.getLoggedUser(),this.departmentId=this.user?.profile?.department?.id,this.divisionId=this.user?.profile?.division?.id}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}}return e.\u0275fac=function(t){return new(t||e)(n.Y36(P.i),n.Y36(Q.h),n.Y36(M.F),n.Y36(r.xA),n.Y36(E.$),n.Y36(n.sBO),n.Y36(r.E7),n.Y36(h.K))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-plan-sub-out-branch"]],hostBindings:function(t,u){1&t&&n.NdJ("resize",function(a){return u.onResize(a)},!1,n.Jf7)},decls:14,vars:16,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","align-items-center"],[4,"ngIf"],[1,"text-2xl","font-semibold","ml-2"],["dataKey","id","currentPageReportTemplate","\u0eaa\u0eb0\u0ec1\u0e94\u0e87 {first} \u0e88\u0eb2\u0e81\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 {last} \u0e82\u0ead\u0e87 {totalRecords} \u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","tableStyle","rowsPerPageOptions","onRowExpand"],["pTemplate","body"],["pTemplate","rowexpansion"],["icon","pi pi-chevron-right","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],["icon","pi pi-chevron-left","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],[2,"width","4rem"],["type","button","pButton","","pRipple","",1,"p-button-secondary","p-button-outlined","p-button-rounded",3,"pRowToggler","icon"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",1,"text-lg","text-left",3,"pTooltip"],[1,"text-groupheader","font-semibold","text-xl"],[1,"font-bold","mr-2"],[1,"font-semibold"],[1,"white-space-nowrap","text-center",2,"width","4rem"],[1,"ml-auto"],[3,"workflowId","task","isBranch"],["colspan","8"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","header"],["pTemplate","emptymessage"],[1,"text-center","white-space-nowrap"],[1,"text-center"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",1,"text-left",3,"pTooltip"],[1,"max-w-15rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],["severity","success",3,"value","rounded"],[1,"white-space-nowrap","text-center"],[1,"flex","gap-1","align-items-center","justify-content-center"],[1,"flex","justify-content-center","cursor-pointer",3,"click"],[3,"taskStatus"],[3,"taskWfId","taskMainId","planSub"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"text-xs","white-space-nowrap"],[4,"ngFor","ngForOf","ngForTrackBy"],["tooltipPosition","bottom","shape","circle",3,"pTooltip","label"],["colspan","8",1,"text-center","pt-4","border-bottom-none"]],template:function(t,u){1&t&&(n.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),n.YNc(4,J,2,0,"div",4),n.ALo(5,"async"),n.YNc(6,F,2,0,"div",4),n.ALo(7,"async"),n.TgZ(8,"span",5),n._uU(9,"\u0e81\u0eb2\u0e99\u0e88\u0eb1\u0e94\u0e81\u0eb2\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d\u0ec1\u0e9c\u0e99\u0eaa\u0eb9\u0ec9\u0e8a\u0ebb\u0e99"),n.qZA()()(),n._UZ(10,"hr"),n.TgZ(11,"p-table",6),n.NdJ("onRowExpand",function(a){return u.onRowExpand(a)}),n.YNc(12,Y,12,8,"ng-template",7),n.YNc(13,nn,7,1,"ng-template",8),n.qZA()()()),2&t&&(n.xp6(4),n.Q6J("ngIf",!n.lcZ(5,9,u.showMenu$)),n.xp6(2),n.Q6J("ngIf",n.lcZ(7,11,u.showMenu$)),n.xp6(5),n.Q6J("value",u.workflows)("paginator",!0)("rows",5)("showCurrentPageReport",!0)("tableStyle",n.DdM(13,tn))("rowsPerPageOptions",n.DdM(14,en))("tableStyle",n.DdM(15,on)))},dependencies:[c.sg,c.O5,p.iA,D.jx,p.jB,_.V,B.A,v.u,x.q,T.H,A.Hq,A.zx,I.v,U.k,f.h,c.Ov],encapsulation:2,changeDetection:0}),e})(),resolve:{data:(()=>{class e{constructor(t,u){this.planMainWfService=t,this.userService=u,this.user=this.userService.getLoggedUser()}resolve(t,u){const s=m.e.getMany({divisionId:this.user?.profile?.division?.id});return this.planMainWfService.getMany(s)}}return e.\u0275fac=function(t){return new(t||e)(n.LFG(E.$),n.LFG(h.K))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}];let ln=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[g.Bz.forChild(un),g.Bz]}),e})();var an=i(1493),cn=i(605),rn=i(5825),sn=i(5353),S=i(9981);let pn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[c.ez,S.o]}),e})(),dn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({providers:[r.E7,r.xA],imports:[c.ez,ln,p.U$,_.W,B.o,an.S,v.z,x.F,T.Q,cn.l,rn.T,sn.l,pn,S.o]}),e})()}}]);