"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[8078],{8078:(gt,g,o)=>{o.r(g),o.d(g,{PlanSubOutHqModule:()=>rt});var a=o(6895),m=o(5675),A=o(7489),b=o(7579),T=o(2722),E=o(3033),B=o(3836),C=o(209),t=o(8274),Z=o(6832),P=o(8145),w=o(1094),p=o(4325),f=o(3119),h=o(8386),c=o(793),D=o(805),v=o(6679),x=o(7147),S=o(3608),_=o(8271),d=o(5593),y=o(8558),M=o(6993),H=o(2300),O=o(3948);function k(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"p-button",9),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.menuService.showMenu())}),t.qZA()()}}function q(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"p-button",10),t.NdJ("click",function(){t.CHM(n);const l=t.oxw();return t.KtG(l.menuService.hideMenu())}),t.qZA()()}}function Q(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td",11),t._UZ(2,"button",12),t.qZA(),t.TgZ(3,"td",13)(4,"div",14)(5,"span",15),t._uU(6,"\u0ea7\u0ebd\u0e81\u0eab\u0ebc\u0eb1\u0e81:"),t.qZA(),t.TgZ(7,"span",16),t._uU(8),t.qZA()()(),t.TgZ(9,"td",17)(10,"div",18),t._UZ(11,"app-plan-main-action",19),t.qZA()()()),2&e){const n=i.$implicit,u=i.expanded,l=t.oxw();t.xp6(2),t.Q6J("pRowToggler",n)("icon",u?"pi pi-chevron-down":"pi pi-chevron-right"),t.xp6(1),t.Q6J("pTooltip",l.utilService.getTooltip(null==n||null==n.planMain?null:n.planMain.subject,25)),t.xp6(5),t.AsE("#",null==n||null==n.planMain?null:n.planMain.id,"-",null==n||null==n.planMain?null:n.planMain.subject,""),t.xp6(3),t.Q6J("workflowId",null==n?null:n.id)("task",null==n?null:n.planMain)}}function I(e,i){1&e&&(t.TgZ(0,"tr")(1,"th"),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",25),t._uU(4,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(5,"th"),t._uU(6,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA(),t.TgZ(7,"th",25),t._uU(8,"\u0e99\u0ec9\u0eb3\u0edc\u0eb1\u0e81 (%)"),t.qZA(),t.TgZ(9,"th",25),t._uU(10,"\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA(),t.TgZ(11,"th",25),t._uU(12,"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9"),t.qZA(),t.TgZ(13,"th",25),t._uU(14,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0"),t.qZA(),t.TgZ(15,"th",25),t._uU(16,"\u0e94\u0eb3\u0ec0\u0e99\u0eb5\u0e99\u0e81\u0eb2\u0e99"),t.qZA()())}function J(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-chip",35)(2,"div",36),t._uU(3,"\u0ec0\u0ea7\u0ea5\u0eb2"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit,u=t.oxw(2);t.xp6(1),t.Q6J("pTooltip",u.utilService.dateTimeShortFormat(null==n?null:n.indicatorTime))}}function U(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-chip",35)(2,"div",36),t._uU(3,"\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n?null:n.indicatorQuantity)}}function R(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-chip",35)(2,"div",36),t._uU(3,"\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n||null==n.indicatorQuality?null:n.indicatorQuality.subject)}}function N(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-chip",35)(2,"div",36),t._uU(3,"\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),t.qZA()(),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Q6J("pTooltip",null==n||null==n.indicatorSatisfied?null:n.indicatorSatisfied.subject)}}const Y=function(){return{"background-color":"#dee2e6"}};function F(e,i){if(1&e&&(t.ynx(0),t._UZ(1,"p-avatar",38),t.BQk()),2&e){const n=t.oxw().$implicit;t.xp6(1),t.Akn(t.DdM(4,Y)),t.Q6J("pTooltip",(null==n||null==n.staff?null:n.staff.firstName)+" "+(null==n||null==n.staff?null:n.staff.lastName))("label",null==n||null==n.staff?null:n.staff.firstName.charAt(0))}}function $(e,i){if(1&e&&(t.ynx(0),t.YNc(1,F,2,5,"ng-container",4),t.BQk()),2&e){const n=i.index;t.xp6(1),t.Q6J("ngIf",n<2)}}function j(e,i){1&e&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function z(e,i){if(1&e&&(t.ynx(0),t.TgZ(1,"p-avatarGroup"),t.YNc(2,$,2,1,"ng-container",37),t.YNc(3,j,2,0,"span",4),t.qZA(),t.BQk()),2&e){const n=i.ngIf,u=t.oxw(3);t.xp6(2),t.Q6J("ngForOf",n)("ngForTrackBy",u.trackByFn),t.xp6(1),t.Q6J("ngIf",n.length>2)}}const W=function(){return{width:"50px"}};function G(e,i){if(1&e){const n=t.EpF();t.TgZ(0,"tr")(1,"td"),t._uU(2),t.qZA(),t.TgZ(3,"td",26),t._uU(4),t.qZA(),t.TgZ(5,"td",27)(6,"div",28),t._uU(7),t.qZA()(),t.TgZ(8,"td",26),t._UZ(9,"p-tag",29),t.qZA(),t.TgZ(10,"td",30)(11,"div",31),t.YNc(12,J,4,1,"ng-container",4),t.YNc(13,U,4,1,"ng-container",4),t.YNc(14,R,4,1,"ng-container",4),t.YNc(15,N,4,1,"ng-container",4),t.qZA()(),t.TgZ(16,"td",25)(17,"div",32),t.NdJ("click",function(){const s=t.CHM(n).$implicit,r=t.oxw(2);return t.KtG(r.showAssignee(null==s?null:s.sworkflows))}),t.YNc(18,z,4,3,"ng-container",4),t.qZA()(),t.TgZ(19,"td",25),t._UZ(20,"app-task-status",33),t.qZA(),t.TgZ(21,"td",25),t._UZ(22,"app-plan-sub-action",34),t.qZA()()}if(2&e){const n=i.$implicit,u=i.rowIndex,l=t.oxw().$implicit;t.xp6(2),t.Oqu(u+1),t.xp6(2),t.hij(" ",null==n?null:n.id,""),t.xp6(1),t.Q6J("pTooltip",(null==l||null==l.subject?null:l.subject.length)>25?null==l?null:l.subject:null),t.xp6(2),t.hij(" ",null==n?null:n.subject," "),t.xp6(2),t.Akn(t.DdM(17,W)),t.Q6J("value",(null==n?null:n.weight)+"%")("rounded",!0),t.xp6(3),t.Q6J("ngIf",null==n?null:n.indicatorTime),t.xp6(1),t.Q6J("ngIf",null==n?null:n.indicatorQuantity),t.xp6(1),t.Q6J("ngIf",null==n||null==n.indicatorQuality?null:n.indicatorQuality.id),t.xp6(1),t.Q6J("ngIf",null==n||null==n.indicatorSatisfied?null:n.indicatorSatisfied.id),t.xp6(3),t.Q6J("ngIf",null==n?null:n.sworkflows),t.xp6(2),t.Q6J("taskStatus",null==n?null:n.status),t.xp6(2),t.Q6J("taskWfId",null==l?null:l.id)("taskMainId",null==l||null==l.planMain?null:l.planMain.id)("planSub",n)}}function K(e,i){1&e&&(t.TgZ(0,"tr")(1,"td",39),t._uU(2,"\u0e8d\u0eb1\u0e87\u0e9a\u0ecd\u0ec8\u0ea1\u0eb5\u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d"),t.qZA()())}function L(e,i){if(1&e&&(t.TgZ(0,"tr")(1,"td",20)(2,"div",21)(3,"p-table",22),t.YNc(4,I,17,0,"ng-template",23),t.YNc(5,G,23,18,"ng-template",7),t.YNc(6,K,3,0,"ng-template",24),t.qZA()()()()),2&e){const n=i.$implicit;t.xp6(3),t.Q6J("value",null==n?null:n.planSubs)}}const V=function(){return{"min-width":"50rem"}},X=function(){return[10,25,50]},tt=function(){return{"min-width":"60rem"}},nt=[{path:"",component:(()=>{class e{constructor(n,u,l,s,r,pt,ct,dt){this.filter=n,this.menuService=u,this.utilService=l,this.dialogService=s,this.planMainWfService=r,this.cdr=pt,this.dialogRef=ct,this.userService=dt,this.workflows=[],this.planSubs=[],this.mainMenus=[],this.screenHeight=0,this.showMenu$=this.menuService.menuState$,this.destroy$=new b.x}ngOnInit(){this.initUserData(),this.planMainWfService.items$.pipe((0,T.R)(this.destroy$)).subscribe(n=>{this.workflows=n,this.cdr.markForCheck()}),this.checkScreenSize()}onResize(n){this.checkScreenSize()}showAssignee(n){this.dialogRef=this.dialogService.open(B.R,{header:"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9:",width:window.innerWidth>C.A.lg?"30%":"50%",data:{data:(0,A.cloneDeep)(n)},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4})}onRowExpand(n){const u=n?.data?.planMainId,s=E.e.getPlanSub({departmentId:this.departmentId,divisionId:this.divisionId,planMainId:u},!1);this.planMainWfService.getManyPlanSub(u,s).subscribe()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef&&this.dialogRef.close()}trackByFn(n,u){return u.id||n}initUserData(){this.user=this.userService.getLoggedUser(),this.departmentId=this.user?.profile?.department?.id,this.divisionId=this.user?.profile?.division?.id}checkScreenSize(){this.screenHeight=Math.floor(.6*window.innerHeight),this.cdr.detectChanges()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(Z.i),t.Y36(P.h),t.Y36(w.F),t.Y36(p.xA),t.Y36(f.$),t.Y36(t.sBO),t.Y36(p.E7),t.Y36(h.K))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-plan-sub-out-hq"]],hostBindings:function(n,u){1&n&&t.NdJ("resize",function(s){return u.onResize(s)},!1,t.Jf7)},decls:14,vars:16,consts:[[1,"p-grid"],[1,"p-col-12"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","align-items-center"],[4,"ngIf"],[1,"text-2xl","font-semibold","ml-2"],["dataKey","id","currentPageReportTemplate","\u0eaa\u0eb0\u0ec1\u0e94\u0e87 {first} \u0e88\u0eb2\u0e81\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 {last} \u0e82\u0ead\u0e87 {totalRecords} \u0ea5\u0eb2\u0e8d\u0e87\u0eb2\u0e99","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","tableStyle","rowsPerPageOptions","onRowExpand"],["pTemplate","body"],["pTemplate","rowexpansion"],["icon","pi pi-chevron-right","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],["icon","pi pi-chevron-left","styleClass","p-button-outlined p-button-sm mr-2",3,"click"],[2,"width","4rem"],["type","button","pButton","","pRipple","",1,"p-button-secondary","p-button-outlined","p-button-rounded",3,"pRowToggler","icon"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",1,"text-lg","text-left",3,"pTooltip"],[1,"text-groupheader","font-semibold","text-xl"],[1,"font-bold","mr-2"],[1,"font-semibold"],[1,"white-space-nowrap","text-center",2,"width","4rem"],[1,"ml-auto"],[3,"workflowId","task"],["colspan","8"],[1,"p-3"],["dataKey","id",3,"value"],["pTemplate","header"],["pTemplate","emptymessage"],[1,"text-center","white-space-nowrap"],[1,"text-center"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",1,"text-left",3,"pTooltip"],[1,"max-w-15rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],["severity","success",3,"value","rounded"],[1,"white-space-nowrap","text-center"],[1,"flex","gap-1","align-items-center","justify-content-center"],[1,"flex","justify-content-center","cursor-pointer",3,"click"],[3,"taskStatus"],[3,"taskWfId","taskMainId","planSub"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"text-xs","white-space-nowrap"],[4,"ngFor","ngForOf","ngForTrackBy"],["tooltipPosition","bottom","shape","circle",3,"pTooltip","label"],["colspan","8",1,"text-center","pt-4","border-bottom-none"]],template:function(n,u){1&n&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t.YNc(4,k,2,0,"div",4),t.ALo(5,"async"),t.YNc(6,q,2,0,"div",4),t.ALo(7,"async"),t.TgZ(8,"span",5),t._uU(9,"\u0e81\u0eb2\u0e99\u0e88\u0eb1\u0e94\u0e81\u0eb2\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e8d\u0ec8\u0ead\u0e8d\u0ec1\u0e9c\u0e99\u0eaa\u0eb9\u0ec9\u0e8a\u0ebb\u0e99"),t.qZA()()(),t._UZ(10,"hr"),t.TgZ(11,"p-table",6),t.NdJ("onRowExpand",function(s){return u.onRowExpand(s)}),t.YNc(12,Q,12,7,"ng-template",7),t.YNc(13,L,7,1,"ng-template",8),t.qZA()()()),2&n&&(t.xp6(4),t.Q6J("ngIf",!t.lcZ(5,9,u.showMenu$)),t.xp6(2),t.Q6J("ngIf",t.lcZ(7,11,u.showMenu$)),t.xp6(5),t.Q6J("value",u.workflows)("paginator",!0)("rows",25)("showCurrentPageReport",!0)("tableStyle",t.DdM(13,V))("rowsPerPageOptions",t.DdM(14,X))("tableStyle",t.DdM(15,tt)))},dependencies:[a.sg,a.O5,c.iA,D.jx,c.jB,v.V,x.A,S.u,_.q,d.Hq,d.zx,y.H,M.v,H.k,O.h,a.Ov],encapsulation:2,changeDetection:0}),e})(),resolve:{data:(()=>{class e{constructor(n,u){this.planMainWfService=n,this.userService=u,this.user=this.userService.getLoggedUser()}resolve(n,u){const r=E.e.getMany({divisionId:this.user?.profile?.division?.id});return this.planMainWfService.getMany(r)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(f.$),t.LFG(h.K))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()}}];let et=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.Bz.forChild(nt),m.Bz]}),e})();var it=o(1493);let ot=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[a.ez]}),e})();var ut=o(5825),lt=o(5353),st=o(9981),at=o(7639);let rt=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[p.E7,p.xA],imports:[a.ez,et,c.U$,v.W,x.o,it.S,S.z,_.F,d.hJ,y.Q,ut.T,lt.l,st.o,at.n,ot]}),e})()}}]);