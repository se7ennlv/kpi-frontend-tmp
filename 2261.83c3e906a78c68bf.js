"use strict";(self.webpackChunkavalon_ng=self.webpackChunkavalon_ng||[]).push([[2261],{1231:(S,Z,o)=>{o.d(Z,{$:()=>b});var i=o(8274),A=o(433),_=o(7579),D=o(2722),T=o(2569),E=o(8386),p=o(1601),c=o(6895),h=o(2156),g=o(5722),r=o(805);function C(v,x){if(1&v&&(i.TgZ(0,"small",8),i._uU(1),i.qZA()),2&v){const l=i.oxw(2);i.xp6(1),i.hij(" *",null==l.control.errors.notEmpty?null:l.control.errors.notEmpty.message," ")}}function t(v,x){if(1&v&&(i.ynx(0),i.TgZ(1,"label",5)(2,"span",6),i._uU(3),i.qZA(),i.YNc(4,C,2,1,"small",7),i.qZA(),i.BQk()),2&v){const l=i.oxw();i.xp6(3),i.Oqu(l.label),i.xp6(1),i.Q6J("ngIf",l.submitted&&l.control.errors)}}function y(v,x){if(1&v&&(i.TgZ(0,"div",9),i._UZ(1,"i",10),i.TgZ(2,"span"),i._uU(3),i.qZA()()),2&v){const l=x.$implicit;i.xp6(3),i.lnq("[",null==l?null:l.staffCode,"]-",null==l?null:l.firstName," ",null==l?null:l.lastName,"")}}let b=(()=>{class v{constructor(l,f,I,U,M){this.parentForm=l,this.cdr=f,this.loadingService=I,this.userService=U,this.staffService=M,this.submitted=!1,this.showLabel=!0,this.showAddon=!0,this.editMode=!1,this.filterByHead=!0,this.label="\u0e9e\u0eb0\u0e99\u0eb1\u0e81\u0e87\u0eb2\u0e99",this.placeholder="\u0ec0\u0ea5\u0eb7\u0ead\u0e81",this.hint="",this.formControlName="staffCode",this.onChange=()=>{},this.onTouched=()=>{},this.staffs=[],this.loading$=this.loadingService.state$,this.destroy$=new _.x}get control(){return this.formGroup.get(this.formControlName)}writeValue(l){this.selectedValue=l}registerOnChange(l){this.onChange=l}registerOnTouched(l){this.onTouched=l}setDisabledState(l){}onDropdownChange(l){const f=l.value;this.selectedValue=f,this.onChange(f),this.onTouched()}ngOnInit(){this.user=this.userService.getLoggedUser(),this.formGroup=this.parentForm.control,this.staffService.staffs$.pipe((0,D.R)(this.destroy$)).subscribe(l=>{this.staffs=l,this.cdr.detectChanges()}),this.editMode&&this.getStaffs()}getStaffs(){if(this.filterByHead){const l=this.user?.profile?.staffCode;if(l){const f=Object.assign({head1:l,head2:l,head3:l});this.staffService.getAll("field-sm",f).subscribe()}}}ngOnDestroy(){this.destroy$.next(null),this.destroy$.complete()}}return v.\u0275fac=function(l){return new(l||v)(i.Y36(A.sg),i.Y36(i.sBO),i.Y36(T.b),i.Y36(E.K),i.Y36(p.x))},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-dropdown-staff-multi"]],inputs:{submitted:"submitted",showLabel:"showLabel",showAddon:"showAddon",editMode:"editMode",filterByHead:"filterByHead",label:"label",placeholder:"placeholder",hint:"hint",formControlName:"formControlName"},features:[i._Bn([{provide:A.JU,useExisting:(0,i.Gpc)(()=>v),multi:!0}])],decls:6,vars:10,consts:[[3,"formGroup"],[4,"ngIf"],["appendTo","body","id","assignedTo","defaultLabel","\u0ec0\u0ea5\u0eb7\u0ead\u0e81","optionValue","staffCode","optionLabel","firstName","filterBy","staffCode,firstName,lastName","emptyFilterMessage","\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99","display","chip",3,"options","showToggleAll","filter","resetFilterOnHide","emptyMessage","formControlName","onChange","onFocus"],["multiSelect",""],["pTemplate","item"],["for","assignedTo",1,"font-semibold","white-space-nowrap","mr-1"],[1,"text-lg"],["class","p-error",4,"ngIf"],[1,"p-error"],[1,"flex","align-items-center","gap-2"],[1,"pi","pi-user"]],template:function(l,f){1&l&&(i.TgZ(0,"form",0),i.YNc(1,t,5,2,"ng-container",1),i.TgZ(2,"p-multiSelect",2,3),i.NdJ("onChange",function(U){return f.onDropdownChange(U)})("onFocus",function(){return f.getStaffs()}),i.ALo(4,"async"),i.YNc(5,y,4,3,"ng-template",4),i.qZA()()),2&l&&(i.Q6J("formGroup",f.formGroup),i.xp6(1),i.Q6J("ngIf",f.showLabel),i.xp6(1),i.Q6J("options",f.staffs)("showToggleAll",!1)("filter",!0)("resetFilterOnHide",!0)("emptyMessage",i.lcZ(4,8,f.loading$)?"\u0e81\u0eb3\u0ea5\u0eb1\u0e87\u0ec2\u0eab\u0ebc\u0e94..":"\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99")("formControlName",f.formControlName))},dependencies:[c.O5,A._Y,A.JJ,A.JL,A.sg,A.u,h.bc,h.VP,h.YE,g.NU,r.jx,c.Ov],encapsulation:2,changeDetection:0}),v})()},1601:(S,Z,o)=>{o.d(Z,{x:()=>p});var i=o(2340),A=o(1135),_=o(8505),D=o(4004),T=o(8274),E=o(529);let p=(()=>{class c{constructor(g){this.http=g,this.apiPath="staffs",this.staffs=new A.X([]),this.staffs$=this.staffs.asObservable(),this.apiUrl=`${i.N.apiUrl}/v1/${this.apiPath}`}getAll(g,r){return this.http.get(`${this.apiUrl}/${g}`,{params:r}).pipe((0,_.b)(t=>{200===t?.statusCode&&t?.data&&this.staffs.next(t.data)}))}getAllHead(){return this.http.get(`${this.apiUrl}/head`).pipe((0,_.b)(r=>{200===r?.statusCode&&r?.data&&this.staffs.next(r.data)}))}countStaff(g){return this.http.get(`${i.N.apiUrl}/v1/report-staff-score/count`,{params:g}).pipe((0,D.U)(C=>200===C?.statusCode&&C?.data?.rowCount?C?.data?.rowCount:0))}}return c.\u0275fac=function(g){return new(g||c)(T.LFG(E.eN))},c.\u0275prov=T.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"}),c})()},2261:(S,Z,o)=>{o.r(Z),o.d(Z,{AssignOutModule:()=>fe});var i=o(6895),A=o(5675),_=o(7489),D=o(7579),T=o(2722),E=o(3836),p=o(2156),c=o(1837),h=o(655);class g{}(0,h.gn)([(0,p.C1)()],g.prototype,"taskSubject",void 0),(0,h.gn)([(0,p.C1)({conditionalExpression:n=>!(null!==n.indicatorQuantity&&""!=n.indicatorQuantity||null!==n.qualityIndicatorId&&n.qualityIndicatorId||null!==n.satisfiedIndicatorId&&n.satisfiedIndicatorId)})],g.prototype,"indicatorTime",void 0),(0,h.gn)([(0,p.C1)({conditionalExpression:n=>!(null!==n.indicatorTime&&""!=n.indicatorTime||null!==n.qualityIndicatorId&&n.qualityIndicatorId||null!==n.satisfiedIndicatorId&&n.satisfiedIndicatorId)})],g.prototype,"indicatorQuantity",void 0),(0,h.gn)([(0,p.C1)({conditionalExpression:n=>!(null!==n.indicatorTime&&""!=n.indicatorTime||null!==n.indicatorQuantity&&""!=n.indicatorQuantity||null!==n.satisfiedIndicatorId&&n.satisfiedIndicatorId)})],g.prototype,"qualityIndicatorId",void 0),(0,h.gn)([(0,p.C1)({conditionalExpression:n=>!(null!==n.indicatorTime&&""!=n.indicatorTime||null!==n.indicatorQuantity&&""!=n.indicatorQuantity||null!==n.qualityIndicatorId&&n.qualityIndicatorId)})],g.prototype,"satisfiedIndicatorId",void 0),(0,h.gn)([(0,p.C1)()],g.prototype,"priorityId",void 0),(0,h.gn)([(0,p.IE)(),(0,p.Dw)()],g.prototype,"assignedTo",void 0),(0,h.gn)([(0,p.vg)()],g.prototype,"description",void 0);var r=o(6620),C=o(6819),t=o(8274),y=o(704),b=o(841),v=o(2392),x=o(6514),l=o(4325),f=o(433),I=o(805),U=o(1740),M=o(5593),w=o(2946),J=o(1376),F=o(585),Y=o(695),k=o(1231),P=o(2634),N=o(299);function V(n,a){1&n&&(t.TgZ(0,"span",28),t._uU(1,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94"),t.qZA())}function X(n,a){if(1&n&&(t.TgZ(0,"small",29),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.taskSubject.errors.required?null:e.controls.taskSubject.errors.required.message," ")}}function tt(n,a){1&n&&(t.TgZ(0,"span",28),t._uU(1,"\u0e81\u0eb3\u0e99\u0ebb\u0e94\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA())}function et(n,a){1&n&&(t.ynx(0),t.TgZ(1,"div",30)(2,"small",29),t._uU(3," *\u0e81\u0eb0\u0ea5\u0eb8\u0e99\u0eb2\u0e81\u0eb3\u0e99\u0ebb\u0e94\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94\u0ea2\u0ec8\u0eb2\u0e87\u0edc\u0ec9\u0ead\u0e8d\u0edc\u0eb6\u0ec8\u0e87\u0e82\u0ecd\u0ec9\u0e82\u0eb6\u0ec9\u0e99\u0ec4\u0e9b "),t.qZA()(),t.BQk())}function nt(n,a){if(1&n&&(t.TgZ(0,"small",29),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.description.errors.required?null:e.controls.description.errors.required.message," ")}}let it=(()=>{class n{constructor(e,s,u,d,m,B){this.fb=e,this.alertService=s,this.formService=u,this.taskAssignService=d,this.taskWfService=m,this.dialogRef=B,this.submitted=!1,this.newFiles=[],p.jc.set(this.formService.validationMessages)}get controls(){return this.formGroup.controls}ngOnInit(){this.formGroup=this.fb.formGroup(new g)}checkIndicators(){const{indicatorTime:e,indicatorQuantity:s,qualityIndicatorId:u,satisfiedIndicatorId:d}=this.controls;return this.submitted&&!!(e.errors||s.errors||u.errors||d.errors)}onSubmit(){if(this.submitted=!0,this.formGroup.invalid)return;const e=this.formGroup.value;if(e.indicatorTime){const d=c.ou.fromJSDate(e.indicatorTime).toFormat("yyyy-MM-dd HH:mm");e.indicatorTime=d}this.formGroup.disable();const s=_.omit(e,["staffCode"]);this.taskAssignService.create(s).subscribe({next:u=>{const d=u?.id;d&&(this.getOne(d),this.child.onCheckFileUpload(d,"task-assign"),setTimeout(()=>{const B=e.assignedTo.map(O=>Object.assign({taskId:d,assignedTo:O}));this.createWorflow(d,B)},500),this.alertService.showSuccess("\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99\u0ec1\u0ea5\u0ec9\u0ea7")),this.closeDialog()},error:u=>{this.formGroup.enable(),this.alertService.showError(u)}})}createWorflow(e,s){this.taskWfService.create(s).subscribe({next:u=>{u&&this.taskWfService.getWorkflow(e)},error:u=>{this.alertService.showError(u)}})}getOne(e){const u=C.M.getOne({id:e});this.taskAssignService.getOneAndPushNew(u).subscribe()}closeDialog(){this.submitted=!1,this.formGroup.reset(),this.formGroup.enable(),this.dialogRef&&this.dialogRef.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.GW),t.Y36(y.c),t.Y36(b.k),t.Y36(v.G),t.Y36(x.y),t.Y36(l.E7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-create-form"]],viewQuery:function(e,s){if(1&e&&t.Gf(r.u,5),2&e){let u;t.iGM(u=t.CRH())&&(s.child=u.first)}},decls:53,vars:23,consts:[[3,"formGroup"],[3,"toggleable"],["pTemplate","header"],[1,"formgrid","grid","p-fluid"],[1,"field","col-12"],["for","taskSubject",1,"font-semibold","text-lg","mb-0"],["class","p-error",4,"ngIf"],["type","text","id","taskSubject","pInputText","","formControlName","taskSubject"],[1,"field","col-6"],[3,"submitted"],[3,"label","formControlName","submitted"],["styleClass","my-4",3,"toggleable"],["for","indicatorTime",1,"font-semibold","mb-0"],["appendTo","body","dateFormat","dd/mm/yy","formControlName","indicatorTime","placeholder","\u0e84\u0eb2\u0e94\u0edd\u0eb2\u0e8d\u0eaa\u0eb3\u0ec0\u0ea5\u0eb1\u0e94",3,"readonlyInput","showTime","showIcon"],["for","indicatorQuantity",1,"font-semibold","mb-0"],["type","text","id","indicatorQuantity","pInputText","","formControlName","indicatorQuantity","placeholder","\u0e9b\u0ec9\u0ead\u0e99\u0e88\u0eb3\u0e99\u0ea7\u0e99\u0e95\u0ebb\u0ea7\u0ec0\u0ea5\u0e81"],[1,"font-semibold","mb-0"],[4,"ngIf"],["for","description",1,"font-semibold","text-lg","mb-0"],[3,"readonly","formControlName"],[1,"field","col-12","mt-6"],["for","files-input",1,"flex","align-items-center","cursor-pointer","mb-0"],[1,"pi","pi-paperclip"],[1,"ml-1","font-semibold","text-lg"],[3,"apiPath","oldFiles","attachRefId"],[1,"text-right","mt-4"],["label","\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81","icon","pi pi-times","styleClass","p-button-outlined mr-2",3,"disabled","click"],["label","\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81","icon","pi pi-check",3,"loading","disabled","click"],[1,"font-semibold","text-lg"],[1,"p-error"],[1,"col-12","py-0"]],template:function(e,s){1&e&&(t.TgZ(0,"div")(1,"form",0)(2,"p-fieldset",1),t.YNc(3,V,2,0,"ng-template",2),t.TgZ(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e97\u0eb5\u0ec8\u0eaa\u0ec9\u0eb2\u0e87\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d "),t.YNc(8,X,2,1,"small",6),t.qZA(),t._UZ(9,"input",7),t.qZA(),t.TgZ(10,"div",8),t._UZ(11,"app-dropdown-priority",9),t.qZA(),t.TgZ(12,"div",8),t._UZ(13,"app-dropdown-staff-multi",10),t.qZA()()(),t.TgZ(14,"p-fieldset",11),t.YNc(15,tt,2,0,"ng-template",2),t.TgZ(16,"div",3)(17,"div",8)(18,"label",12),t._uU(19,"\u0e94\u0ec9\u0eb2\u0e99\u0ec0\u0ea7\u0ea5\u0eb2"),t.qZA(),t._UZ(20,"p-calendar",13),t.qZA(),t.TgZ(21,"div",8)(22,"label",14),t._uU(23,"\u0e94\u0ec9\u0eb2\u0e99\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),t.qZA(),t._UZ(24,"input",15),t.qZA(),t.TgZ(25,"div",8)(26,"label",16),t._uU(27,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),t.qZA(),t._UZ(28,"app-dropdown-ind-quality",9),t.qZA(),t.TgZ(29,"div",8)(30,"label",16),t._uU(31,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),t.qZA(),t._UZ(32,"app-dropdown-ind-satisfied",9),t.qZA(),t.YNc(33,et,4,0,"ng-container",17),t.qZA()(),t.TgZ(34,"div",3)(35,"div",4)(36,"label",18),t._uU(37,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0ec0\u0e9e\u0eb5\u0ec8\u0ea1\u0ec0\u0e95\u0eb5\u0ea1 "),t.TgZ(38,"small"),t._uU(39,"(\u0ea7\u0ec8\u0eb2\u0e87\u0ec4\u0e94\u0ec9)"),t.qZA(),t.YNc(40,nt,2,1,"small",6),t.qZA(),t._UZ(41,"app-shared-editor",19),t.qZA(),t.TgZ(42,"div",20)(43,"label",21),t._UZ(44,"i",22),t.TgZ(45,"span",23),t._uU(46,"\u0ec1\u0e99\u0e9a\u0ec0\u0ead\u0e81\u0eb0\u0eaa\u0eb2\u0e99 "),t.TgZ(47,"small"),t._uU(48,"(jpg, png, pdf)"),t.qZA()()(),t._UZ(49,"app-upload-helper",24),t.qZA()()(),t.TgZ(50,"div",25)(51,"p-button",26),t.NdJ("click",function(){return s.closeDialog()}),t.qZA(),t.TgZ(52,"p-button",27),t.NdJ("click",function(){return s.onSubmit()}),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",s.formGroup),t.xp6(1),t.Q6J("toggleable",!0),t.xp6(6),t.Q6J("ngIf",s.submitted&&s.controls.taskSubject.errors),t.xp6(3),t.Q6J("submitted",s.submitted),t.xp6(2),t.Q6J("label","\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9")("formControlName","assignedTo")("submitted",s.submitted),t.xp6(1),t.Q6J("toggleable",!0),t.xp6(6),t.Q6J("readonlyInput",!0)("showTime",!0)("showIcon",!0),t.xp6(8),t.Q6J("submitted",s.submitted),t.xp6(4),t.Q6J("submitted",s.submitted),t.xp6(1),t.Q6J("ngIf",s.checkIndicators()),t.xp6(7),t.Q6J("ngIf",s.submitted&&s.controls.description.errors),t.xp6(1),t.Q6J("readonly",s.formGroup.disabled)("formControlName","description"),t.xp6(8),t.Q6J("apiPath","assign-attachments")("oldFiles",null)("attachRefId",1),t.xp6(2),t.Q6J("disabled",s.formGroup.disabled),t.xp6(1),t.Q6J("loading",s.formGroup.disabled)("disabled",s.formGroup.disabled))},dependencies:[i.O5,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,p.bc,p.VP,p.YE,I.jx,U.o,M.zx,w.p,J.$,F.f,Y.d,k.$,P.k,N.t,r.u],encapsulation:2}),n})();var G=o(209),ot=o(7248),R=o(1094),st=o(6832),j=o(7960),W=o(793),H=o(3608),Q=o(6679),L=o(8271),q=o(8558),ut=o(3446),at=o(3948),rt=o(6521),lt=o(1481),$=o(7147),dt=o(3609),pt=o(8065),ct=o(8739);function Et(n,a){if(1&n&&t._UZ(0,"div",16),2&n){const e=t.oxw(2).ngIf,s=t.oxw();t.Q6J("innerHTML",s.transform(null==e?null:e.description),t.oJD)}}function mt(n,a){if(1&n&&(t.TgZ(0,"div",7)(1,"label",4),t._uU(2,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0ec0\u0e9e\u0eb5\u0ec8\u0ea1\u0ec0\u0e95\u0eb5\u0ea1"),t.qZA(),t.YNc(3,Et,1,1,"div",15),t.qZA()),2&n){const e=t.oxw().ngIf;t.xp6(3),t.Q6J("ngIf",null==e?null:e.description)}}function ft(n,a){if(1&n&&(t.TgZ(0,"div",17)(1,"div")(2,"label",6),t._uU(3,"\u0ec1\u0e81\u0ec9\u0ec4\u0e82\u0eab\u0ebc\u0ec9\u0eb2\u0eaa\u0eb8\u0e94:"),t.qZA()(),t.TgZ(4,"div"),t._uU(5),t.ALo(6,"date"),t.qZA()()),2&n){const e=t.oxw().ngIf;t.xp6(5),t.Oqu(t.xi3(6,1,null==e?null:e.updatedAt,"dd/MM/yyyy HH:mm"))}}function gt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"p-chip",22),t.NdJ("click",function(){const d=t.CHM(e).$implicit,m=t.oxw(3);return t.KtG(m.showPreviewFromUrl(null==d?null:d.filePath))}),t._UZ(1,"i",23),t.TgZ(2,"span",24),t._uU(3),t.qZA()()}if(2&n){const e=a.$implicit;t.xp6(3),t.hij("",null==e?null:e.fileName," ")}}function ht(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",18)(2,"label",4),t._uU(3,"\u0ec0\u0ead\u0e81\u0eb0\u0eaa\u0eb2\u0e99\u0ec1\u0e99\u0e9a"),t.qZA(),t._UZ(4,"hr",19),t.TgZ(5,"div",20),t.YNc(6,gt,4,1,"ng-template",21),t.qZA()(),t.BQk()),2&n){const e=t.oxw().ngIf;t.xp6(6),t.Q6J("ngForOf",e.attachments)}}const At=function(n){return{"background-color":n}};function vt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",3)(2,"div")(3,"label",4),t._uU(4),t.qZA()(),t.TgZ(5,"div",5)(6,"div")(7,"label",6),t._uU(8,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0eaa\u0ec9\u0eb2\u0e87:"),t.qZA()(),t._uU(9),t.ALo(10,"date"),t.qZA(),t.TgZ(11,"div",7)(12,"label",4),t._uU(13,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81"),t.qZA(),t.TgZ(14,"div"),t._uU(15),t.qZA()(),t.TgZ(16,"div",7),t._UZ(17,"app-indicator-detail",8),t.qZA(),t.TgZ(18,"div",5)(19,"div")(20,"label",6),t._uU(21,"\u0ea5\u0eb3\u0e94\u0eb1\u0e9a\u0e84\u0ea7\u0eb2\u0ea1\u0eaa\u0eb3\u0e84\u0eb1\u0e99:"),t.qZA()(),t.TgZ(22,"div"),t._UZ(23,"p-tag",9),t.qZA()(),t.YNc(24,mt,4,1,"div",10),t.TgZ(25,"div",11)(26,"label",4),t._uU(27,"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9:"),t.qZA(),t.TgZ(28,"div",12),t._UZ(29,"app-task-workflow",13),t.qZA()(),t.YNc(30,ft,7,4,"div",14),t.YNc(31,ht,7,1,"ng-container",2),t.qZA(),t.BQk()),2&n){const e=a.ngIf;t.xp6(4),t.hij("\u0e9b\u0eb0\u0e88\u0eb3\u0e9b\u0eb5: ",null==e?null:e.docYear,""),t.xp6(5),t.hij(" ",t.xi3(10,12,null==e?null:e.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(6),t.Oqu(null==e?null:e.taskSubject),t.xp6(2),t.Q6J("item",e),t.xp6(6),t.Akn(t.VKq(15,At,null==e||null==e.priority?null:e.priority.color)),t.Q6J("value",null==e||null==e.priority?null:e.priority.name)("rounded",!0),t.xp6(1),t.Q6J("ngIf",null==e?null:e.description),t.xp6(5),t.Q6J("workflows",null==e?null:e.taskAssignWf),t.xp6(1),t.Q6J("ngIf",null==e?null:e.updatedAt),t.xp6(1),t.Q6J("ngIf",e.attachments&&e.attachments.length)}}function Ct(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"app-file-preview",25),t.NdJ("closePreview",function(){t.CHM(e);const u=t.oxw();return t.KtG(u.closeImgPreview())}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("selectedFileOrUrl",e.fileSrc)}}let _t=(()=>{class n{constructor(e,s,u,d,m){this.dialogConfig=e,this.sanitizer=s,this.taskAssignService=u,this.utilService=d,this.alertService=m,this.visiblePreview=!1}ngOnInit(){this.taskId=this.dialogConfig.data.data,this.getTaskDetail(),this.taskMain$=this.taskAssignService.item$}getTaskDetail(){if(this.taskId){const s=C.M.getDetail({id:this.taskId});this.taskAssignService.getOne(s).subscribe()}}transform(e){return this.sanitizer.bypassSecurityTrustHtml(e)}closeImgPreview(){this.visiblePreview=!1}showPreviewFromUrl(e){e&&(this.utilService.isValidUrl(e)?(this.fileSrc=e,this.visiblePreview=!0):this.alertService.showDanger("\u0eae\u0eb9\u0e9a\u0ec1\u0e9a\u0e9a\u0e97\u0eb5\u0ec8\u0ea2\u0eb9\u0ec8\u0e82\u0ead\u0e87\u0ec4\u0e9f\u0ea5\u0ecc\u0e9a\u0ecd\u0ec8\u0e96\u0eb7\u0e81\u0e95\u0ec9\u0ead\u0e87!"))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.S),t.Y36(lt.H7),t.Y36(v.G),t.Y36(R.F),t.Y36(y.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-detail"]],decls:5,vars:4,consts:[[1,"grid"],[1,"col-12"],[4,"ngIf"],[1,"p-fluid"],[1,"font-semibold","text-xl","mb-0"],[1,"field","flex","align-items-center","gap-2"],[1,"font-semibold","text-xl"],[1,"field"],[3,"item"],["styleClass","px-4",3,"value","rounded"],["class","field",4,"ngIf"],[1,"field","flex-column","align-items-center","gap-2"],[1,"ml-5"],[3,"workflows"],["class","field flex align-items-center gap-2 mt-5",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"field","flex","align-items-center","gap-2","mt-5"],[1,"field","mt-5"],[1,"mt-0"],[1,"flex","gap-2"],["ngFor","",3,"ngForOf"],["styleClass","cursor-pointer",3,"click"],[1,"pi","pi-paperclip","mr-2","text-green-500"],[1,"w-8rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[3,"selectedFileOrUrl","closePreview"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,vt,32,17,"ng-container",2),t.ALo(3,"async"),t.qZA()(),t.YNc(4,Ct,2,1,"ng-container",2)),2&e&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,2,s.taskMain$)),t.xp6(2),t.Q6J("ngIf",s.visiblePreview))},dependencies:[i.sg,i.O5,Q.V,$.A,dt.Q,pt.I,ct.Q,i.Ov,i.uU],encapsulation:2}),n})();var Bt=o(9300),z=o(3900),Tt=o(9646);function yt(n,a){1&n&&(t.TgZ(0,"span",29),t._uU(1,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94"),t.qZA())}function Zt(n,a){if(1&n&&(t.TgZ(0,"small",30),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.taskSubject.errors.required?null:e.controls.taskSubject.errors.required.message," ")}}function Dt(n,a){1&n&&(t.TgZ(0,"span",29),t._uU(1,"\u0e81\u0eb3\u0e99\u0ebb\u0e94\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA())}function xt(n,a){1&n&&(t.ynx(0),t.TgZ(1,"div",31)(2,"small",30),t._uU(3," *\u0e81\u0eb0\u0ea5\u0eb8\u0e99\u0eb2\u0e81\u0eb3\u0e99\u0ebb\u0e94\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94\u0ea2\u0ec8\u0eb2\u0e87\u0edc\u0ec9\u0ead\u0e8d\u0edc\u0eb6\u0ec8\u0e87\u0e82\u0ecd\u0ec9\u0e82\u0eb6\u0ec9\u0e99\u0ec4\u0e9b "),t.qZA()(),t.BQk())}function bt(n,a){if(1&n&&(t.TgZ(0,"small",30),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" *",null==e.controls.description.errors.required?null:e.controls.description.errors.required.message," ")}}let It=(()=>{class n{constructor(e,s,u,d,m,B,O,ge){this.formService=e,this.fb=s,this.taskAssignService=u,this.taskWfService=d,this.alertService=m,this.dialogRef=B,this.dialogConfig=O,this.cdr=ge,this.submitted=!1,this.newFiles=[],this.destroy$=new D.x,p.jc.set(this.formService.validationMessages)}get controls(){return this.formGroup.controls}ngOnInit(){this.taskId=this.dialogConfig.data.data,this.formGroup=this.fb.formGroup(new g),this.taskId&&this.getTaskDetails()}getTaskDetails(){this.taskAssignService.getTaskDetail(this.taskId).pipe((0,T.R)(this.destroy$),(0,Bt.h)(e=>!!e)).subscribe(e=>{this.task=e,this.populateForm(e),this.cdr.detectChanges()})}populateForm(e){if(!e)return;const s=e.priority?.id,u=e?.indicatorQuality?.id,d=e?.indicatorSatisfied?.id,m=e?.indicatorTime?new Date(e?.indicatorTime):null;this.formGroup.patchValue({...e,priorityId:s,qualityIndicatorId:u,satisfiedIndicatorId:d,indicatorTime:m}),this.getTaskWorkflow(this.taskId),this.initMainFormValues=this.formGroup.value}getTaskWorkflow(e){const s=Object.assign({taskId:e}),u=C.M.getWorkflow(s);this.taskWfService.getMany(u).subscribe({next:d=>{if(d&&d.length){let m=d.map(B=>B.assignedTo);this.formGroup.patchValue({assignedTo:m}),this.initWfFormValues=m}}})}checkIndicators(){const{indicatorTime:e,indicatorQuantity:s,qualityIndicatorId:u,satisfiedIndicatorId:d}=this.controls;return this.submitted&&!!(e.errors||s.errors||u.errors||d.errors)}onSubmit(){if(this.submitted=!0,this.formGroup.invalid)return;const e=this.formGroup.value;if(e.indicatorTime){const u=c.ou.fromJSDate(e.indicatorTime).toFormat("yyyy-MM-dd HH:mm");e.indicatorTime=u}if(this.formGroup.disable(),this.taskId){const s=this.formService.getFieldValueChange(this.initMainFormValues,e),u=_.omit(s,["assignedTo"]),d=s.assignedTo,m=this.formService.checkArrayValueChange(this.initWfFormValues,d);this.updateMainTask(u).pipe((0,z.w)(()=>m?this.updateWorkflow(d):(0,Tt.of)(null)),(0,z.w)(()=>this.getOneId()),(0,T.R)(this.destroy$)).subscribe({next:B=>{B&&(this.resetData(),this.alertService.showSuccess("\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99\u0ec1\u0ea5\u0ec9\u0ea7"))},error:B=>{this.alertService.showError(B)}})}}getOneId(){const s=C.M.getOne({id:this.taskId});return this.taskAssignService.getOneAndReplace(s)}updateMainTask(e){return this.taskAssignService.update(this.taskId,e)}updateWorkflow(e){const s=e.map(u=>({taskId:this.taskId,assignedTo:u}));return this.taskWfService.create(s)}resetData(){this.formGroup.reset(),this.formGroup.enable(),this.submitted=!1,this.closeDialog()}closeDialog(){this.dialogRef&&this.dialogRef.close()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(b.k),t.Y36(p.GW),t.Y36(v.G),t.Y36(x.y),t.Y36(y.c),t.Y36(l.E7),t.Y36(l.S),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-update-form"]],viewQuery:function(e,s){if(1&e&&t.Gf(r.u,5),2&e){let u;t.iGM(u=t.CRH())&&(s.child=u.first)}},decls:53,vars:25,consts:[[3,"formGroup"],[3,"toggleable"],["pTemplate","header"],[1,"formgrid","grid","p-fluid"],[1,"field","col-12"],["for","taskSubject",1,"font-semibold","text-lg","mb-0"],["class","p-error",4,"ngIf"],["type","text","id","taskSubject","pInputText","","formControlName","taskSubject"],[1,"field","col-6"],[3,"submitted","editMode"],[3,"label","formControlName","submitted","editMode"],["styleClass","my-4",3,"toggleable"],["for","indicatorTime",1,"font-semibold","mb-0"],["appendTo","body","dateFormat","dd/mm/yy","formControlName","indicatorTime","placeholder","\u0e84\u0eb2\u0e94\u0edd\u0eb2\u0e8d\u0eaa\u0eb3\u0ec0\u0ea5\u0eb1\u0e94",3,"readonlyInput","showTime","showIcon"],["for","indicatorQuantity",1,"font-semibold","mb-0"],["type","text","id","indicatorQuantity","pInputText","","formControlName","indicatorQuantity","placeholder","\u0e9b\u0ec9\u0ead\u0e99\u0e88\u0eb3\u0e99\u0ea7\u0e99\u0e95\u0ebb\u0ea7\u0ec0\u0ea5\u0e81"],[1,"font-semibold","mb-0"],[3,"submitted"],[4,"ngIf"],["for","description",1,"font-semibold","text-lg","mb-0"],[3,"readonly","formControlName"],[1,"field","col-12","mt-6"],["for","files-input",1,"flex","align-items-center","cursor-pointer","mb-0"],[1,"pi","pi-paperclip"],[1,"ml-1","font-semibold","text-lg"],[3,"apiPath","oldFiles","attachRefId"],[1,"text-right","mt-4"],["label","\u0e8d\u0ebb\u0e81\u0ec0\u0ea5\u0eb5\u0e81","icon","pi pi-times","styleClass","p-button-outlined mr-2",3,"disabled","click"],["label","\u0e9a\u0eb1\u0e99\u0e97\u0eb6\u0e81","icon","pi pi-check",3,"loading","disabled","click"],[1,"font-semibold","text-lg"],[1,"p-error"],[1,"col-12","py-0"]],template:function(e,s){1&e&&(t.TgZ(0,"div")(1,"form",0)(2,"p-fieldset",1),t.YNc(3,yt,2,0,"ng-template",2),t.TgZ(4,"div",3)(5,"div",4)(6,"label",5),t._uU(7,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e97\u0eb5\u0ec8\u0eaa\u0ec9\u0eb2\u0e87\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d "),t.YNc(8,Zt,2,1,"small",6),t.qZA(),t._UZ(9,"input",7),t.qZA(),t.TgZ(10,"div",8),t._UZ(11,"app-dropdown-priority",9),t.qZA(),t.TgZ(12,"div",8),t._UZ(13,"app-dropdown-staff-multi",10),t.qZA()()(),t.TgZ(14,"p-fieldset",11),t.YNc(15,Dt,2,0,"ng-template",2),t.TgZ(16,"div",3)(17,"div",8)(18,"label",12),t._uU(19,"\u0e94\u0ec9\u0eb2\u0e99\u0ec0\u0ea7\u0ea5\u0eb2"),t.qZA(),t._UZ(20,"p-calendar",13),t.qZA(),t.TgZ(21,"div",8)(22,"label",14),t._uU(23,"\u0e94\u0ec9\u0eb2\u0e99\u0e9b\u0eb0\u0ea5\u0eb4\u0ea1\u0eb2\u0e99"),t.qZA(),t._UZ(24,"input",15),t.qZA(),t.TgZ(25,"div",8)(26,"label",16),t._uU(27,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0eb8\u0e99\u0e99\u0eb0\u0e9e\u0eb2\u0e9a"),t.qZA(),t._UZ(28,"app-dropdown-ind-quality",17),t.qZA(),t.TgZ(29,"div",8)(30,"label",16),t._uU(31,"\u0e94\u0ec9\u0eb2\u0e99\u0e84\u0ea7\u0eb2\u0ea1\u0ec0\u0e9e\u0eb4\u0ec8\u0e87\u0e9e\u0ecd\u0ec3\u0e88"),t.qZA(),t._UZ(32,"app-dropdown-ind-satisfied",17),t.qZA(),t.YNc(33,xt,4,0,"ng-container",18),t.qZA()(),t.TgZ(34,"div",3)(35,"div",4)(36,"label",19),t._uU(37,"\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0ec0\u0e9e\u0eb5\u0ec8\u0ea1\u0ec0\u0e95\u0eb5\u0ea1 "),t.TgZ(38,"small"),t._uU(39,"(\u0ea7\u0ec8\u0eb2\u0e87\u0ec4\u0e94\u0ec9)"),t.qZA(),t.YNc(40,bt,2,1,"small",6),t.qZA(),t._UZ(41,"app-shared-editor",20),t.qZA(),t.TgZ(42,"div",21)(43,"label",22),t._UZ(44,"i",23),t.TgZ(45,"span",24),t._uU(46,"\u0ec1\u0e99\u0e9a\u0ec0\u0ead\u0e81\u0eb0\u0eaa\u0eb2\u0e99 "),t.TgZ(47,"small"),t._uU(48,"(jpg, png, pdf)"),t.qZA()()(),t._UZ(49,"app-upload-helper",25),t.qZA()()(),t.TgZ(50,"div",26)(51,"p-button",27),t.NdJ("click",function(){return s.closeDialog()}),t.qZA(),t.TgZ(52,"p-button",28),t.NdJ("click",function(){return s.onSubmit()}),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",s.formGroup),t.xp6(1),t.Q6J("toggleable",!0),t.xp6(6),t.Q6J("ngIf",s.submitted&&s.controls.taskSubject.errors),t.xp6(3),t.Q6J("submitted",s.submitted)("editMode",!0),t.xp6(2),t.Q6J("label","\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9")("formControlName","assignedTo")("submitted",s.submitted)("editMode",!0),t.xp6(1),t.Q6J("toggleable",!0),t.xp6(6),t.Q6J("readonlyInput",!0)("showTime",!0)("showIcon",!0),t.xp6(8),t.Q6J("submitted",s.submitted),t.xp6(4),t.Q6J("submitted",s.submitted),t.xp6(1),t.Q6J("ngIf",s.checkIndicators()),t.xp6(7),t.Q6J("ngIf",s.submitted&&s.controls.description.errors),t.xp6(1),t.Q6J("readonly",s.formGroup.disabled)("formControlName","description"),t.xp6(8),t.Q6J("apiPath","assign-attachments")("oldFiles",null)("attachRefId",1),t.xp6(2),t.Q6J("disabled",s.formGroup.disabled),t.xp6(1),t.Q6J("loading",s.formGroup.disabled)("disabled",s.formGroup.disabled))},dependencies:[i.O5,f._Y,f.Fj,f.JJ,f.JL,f.sg,f.u,p.bc,p.VP,p.YE,I.jx,U.o,M.zx,w.p,J.$,F.f,Y.d,k.$,P.k,N.t,r.u],encapsulation:2}),n})();var K=o(605);function Ut(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"p-splitButton",1),t.NdJ("onClick",function(){const d=t.CHM(e).ngIf,m=t.oxw();return t.KtG(m.showDetail(d))})("onDropdownClick",function(){const d=t.CHM(e).ngIf,m=t.oxw();return t.KtG(m.onDropdownClick(d))}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("model",e.menuItems)}}let St=(()=>{class n{constructor(e,s,u,d){this.taskAssignService=e,this.dialogService=s,this.confirmService=u,this.dialogRef=d,this.menuItems=[],this.dialogOptions={contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,dismissableMask:!1,maximizable:!0}}ngOnInit(){this.menuItems=[{separator:!0},{label:"\u0ec1\u0e81\u0ec9\u0ec4\u0e82",icon:"pi pi-fw pi-pencil",command:()=>{this.showUpdateForm(this.task?.id)}}]}onDropdownClick(e){this.task={...e}}showUpdateForm(e){this.dialogRef=this.dialogService.open(It,{header:`\u0ec1\u0e81\u0ec9\u0ec4\u0e82\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81 #${e}`,width:"80%",data:{data:e},...this.dialogOptions})}showDetail(e){this.dialogRef=this.dialogService.open(_t,{header:`\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94\u0ea7\u0ebd\u0e81\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d #${e?.id}`,width:window.innerWidth>G.A.lg?"65%":"80%",data:{data:(0,_.cloneDeep)(e?.id)},...this.dialogOptions})}onDelete(e){this.confirmService.confirm({message:"\u0ec1\u0e99\u0ec8\u0ec3\u0e88\u0e9a\u0ecd\u0ec8\u0ea7\u0ec8\u0eb2\u0e95\u0ec9\u0ead\u0e87\u0e81\u0eb2\u0e99\u0ea5\u0eb6\u0e9a\u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99\u0e99\u0eb5\u0ec9?",icon:"pi pi-exclamation-triangle",accept:()=>{this.taskAssignService.deleteOne(e).subscribe()}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(v.G),t.Y36(l.xA),t.Y36(I.YP),t.Y36(l.E7))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-btn-action"]],inputs:{task:"task"},decls:1,vars:1,consts:[[4,"ngIf"],["appendTo","body","label","\u0ec0\u0e9a\u0eb4\u0ec8\u0e87\u0ea5\u0eb2\u0e8d\u0ea5\u0eb0\u0ead\u0ebd\u0e94","styleClass","p-button-secondary p-button-sm",3,"model","onClick","onDropdownClick"]],template:function(e,s){1&e&&t.YNc(0,Ut,2,1,"ng-container",0),2&e&&t.Q6J("ngIf",s.task)},dependencies:[i.O5,K.a],encapsulation:2}),n})();function Mt(n,a){1&n&&(t.TgZ(0,"tr")(1,"th",16),t._uU(2,"#"),t.qZA(),t.TgZ(3,"th",17),t._uU(4,"\u0e9b\u0eb0\u0e88\u0eb3\u0e9b\u0eb5"),t.qZA(),t.TgZ(5,"th",17),t._uU(6,"\u0ea5\u0eb0\u0eab\u0eb1\u0e94\u0ea7\u0ebd\u0e81"),t.qZA(),t.TgZ(7,"th",18),t._uU(8,"\u0edc\u0ec9\u0eb2\u0ea7\u0ebd\u0e81\u0e97\u0eb5\u0ec8\u0eaa\u0ec9\u0eb2\u0e87\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d"),t.qZA(),t.TgZ(9,"th",17),t._uU(10,"\u0e95\u0ebb\u0ea7\u0e8a\u0eb5\u0ec9\u0ea7\u0eb1\u0e94"),t.qZA(),t.TgZ(11,"th",17),t._uU(12,"\u0ea5\u0eb3\u0e94\u0eb1\u0e9a\u0e84\u0ea7\u0eb2\u0ea1\u0eaa\u0eb3\u0e84\u0eb1\u0e99"),t.qZA(),t.TgZ(13,"th",17),t._uU(14,"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9"),t.qZA(),t.TgZ(15,"th",17),t._uU(16,"\u0eaa\u0eb0\u0e96\u0eb2\u0e99\u0eb0"),t.qZA(),t.TgZ(17,"th",17),t._uU(18,"\u0ea7\u0eb1\u0e99\u0e97\u0eb5\u0eaa\u0ec9\u0eb2\u0e87"),t.qZA(),t.TgZ(19,"th",17),t._uU(20,"\u0e94\u0eb3\u0ec0\u0e99\u0eb5\u0e99\u0e81\u0eb2\u0e99"),t.qZA()())}const Ot=function(){return{"background-color":"#dee2e6"}};function wt(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"p-avatar",31),t.BQk()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Akn(t.DdM(4,Ot)),t.Q6J("pTooltip",(null==e||null==e.staff?null:e.staff.firstName)+" "+(null==e||null==e.staff?null:e.staff.lastName))("label",null==e||null==e.staff?null:e.staff.firstName.charAt(0))}}function Ft(n,a){if(1&n&&(t.ynx(0),t.YNc(1,wt,2,5,"ng-container",26),t.BQk()),2&n){const e=a.index;t.xp6(1),t.Q6J("ngIf",e<2)}}function Qt(n,a){1&n&&(t.TgZ(0,"span"),t._uU(1,"..."),t.qZA())}function Jt(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"p-avatarGroup"),t.YNc(2,Ft,2,1,"ng-container",30),t.YNc(3,Qt,2,0,"span",26),t.qZA(),t.BQk()),2&n){const e=a.ngIf;t.xp6(2),t.Q6J("ngForOf",e),t.xp6(1),t.Q6J("ngIf",e.length>2)}}const Yt=function(){return{width:"50px"}},kt=function(n){return{"background-color":n}};function Pt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",19),t._uU(2),t.qZA(),t.TgZ(3,"td",17),t._uU(4),t.qZA(),t.TgZ(5,"td",17),t._uU(6),t.qZA(),t.TgZ(7,"td",20)(8,"div",21)(9,"span"),t._uU(10),t.qZA()()(),t.TgZ(11,"td",22),t._UZ(12,"app-indicator-tooltip",23),t.qZA(),t.TgZ(13,"td",16),t._UZ(14,"p-tag",24),t.qZA(),t.TgZ(15,"td")(16,"div",25),t.NdJ("click",function(){const d=t.CHM(e).$implicit,m=t.oxw();return t.KtG(m.showWorkflow(d))}),t.YNc(17,Jt,4,2,"ng-container",26),t.qZA()(),t.TgZ(18,"td",27),t._UZ(19,"app-task-status",28),t.qZA(),t.TgZ(20,"td",17),t._uU(21),t.ALo(22,"date"),t.qZA(),t.TgZ(23,"td",17),t._UZ(24,"app-btn-action",29),t.qZA()()}if(2&n){const e=a.$implicit,s=a.rowIndex,u=t.oxw();t.xp6(1),t.Q6J("ngStyle",t.DdM(18,Yt)),t.xp6(1),t.hij(" ",s+1," "),t.xp6(2),t.hij(" ",null==e?null:e.docYear," "),t.xp6(2),t.hij(" ",null==e?null:e.id," "),t.xp6(1),t.Q6J("pTooltip",u.utilService.getTooltip(null==e?null:e.taskSubject,25)),t.xp6(3),t.Oqu(null==e?null:e.taskSubject),t.xp6(2),t.Q6J("item",e),t.xp6(2),t.Akn(t.VKq(19,kt,null==e||null==e.priority?null:e.priority.color)),t.Q6J("value",null==e||null==e.priority?null:e.priority.name)("rounded",!0),t.xp6(3),t.Q6J("ngIf",null==e?null:e.taskAssignWf),t.xp6(2),t.Q6J("taskStatus",null==e?null:e.status),t.xp6(2),t.hij(" ",t.xi3(22,15,null==e?null:e.createdAt,"dd/MM/yyyy HH:mm")," "),t.xp6(3),t.Q6J("task",e)}}function Nt(n,a){1&n&&(t.TgZ(0,"tr")(1,"td",32),t._uU(2,"\u0e9a\u0ecd\u0ec8\u0e9e\u0ebb\u0e9a\u0e82\u0ecd\u0ec9\u0ea1\u0eb9\u0e99"),t.qZA()())}const Gt=function(){return[25,50,100]},Rt=[{path:"",component:(()=>{class n{constructor(e,s,u,d,m,B,O){this.utilService=e,this.filter=s,this.cdr=u,this.fb=d,this.dialogService=m,this.taskAssignService=B,this.taskHelperService=O,this.tasks=[],this.actionMenus=[],this.filterFields=["id","taskSubject"],this.destroy$=new D.x,this.formGroup=this.fb.formGroup(new ot.U)}ngOnInit(){this.taskAssignService.items$.pipe((0,T.R)(this.destroy$)).subscribe(e=>{this.tasks=e,this.cdr.markForCheck()})}showCreateForm(){this.dialogRef=this.dialogService.open(it,{header:"\u0e81\u0eb2\u0e99\u0eaa\u0ec9\u0eb2\u0e87\u0ea7\u0ebd\u0e81\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d",width:"80%",contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4,dismissableMask:!1,maximizable:!0})}showWorkflow(e){this.dialogRef=this.dialogService.open(E.R,{header:"\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9:",width:window.innerWidth>G.A.lg?"30%":"50%",data:{data:(0,_.cloneDeep)(e?.taskAssignWf)},contentStyle:{overflow:"auto","padding-bottom":"20px"},baseZIndex:1e4})}onSelectedYear(e){if(e.getFullYear()){const u=e.getFullYear();this.taskHelperService.getTaskOut(u).subscribe()}}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.dialogRef?.close()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(R.F),t.Y36(st.i),t.Y36(t.sBO),t.Y36(p.GW),t.Y36(l.xA),t.Y36(v.G),t.Y36(j.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-assign-out"]],decls:19,vars:9,consts:[[1,"p-grid","mt-4"],[1,"p-col-12"],[1,"flex","align-items-center","justify-content-between"],[1,"flex","align-items-center"],[1,"text-2xl","font-semibold","ml-2"],[3,"formGroup"],[3,"yearSelected"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","\u0e84\u0ebb\u0ec9\u0e99\u0eab\u0eb2..",3,"input"],["icon","pi pi-plus","label","\u0ec0\u0e9e\u0eb5\u0ec8\u0ea1\u0ec3\u0edd\u0ec8",1,"ml-2",3,"click"],["scrollHeight","550px","styleClass","p-datatable-sm","currentPageReportTemplate","\u0eaa\u0eb0\u0ec1\u0e94\u0e87 {first} \u0ec0\u0e96\u0eb4\u0e87 {last} \u0e88\u0eb2\u0e81\u0e97\u0eb1\u0e87\u0edd\u0ebb\u0e94 {totalRecords} \u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99",3,"value","rows","paginator","globalFilterFields","scrollable","showCurrentPageReport","rowsPerPageOptions"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[1,"text-center"],[1,"white-space-nowrap","text-center"],[1,"white-space-nowrap"],[1,"text-center",3,"ngStyle"],["tooltipPosition","bottom","tooltipStyleClass","custom-tooltip",3,"pTooltip"],[1,"max-w-28rem","xl:max-w-30rem","white-space-nowrap","overflow-hidden","text-overflow-ellipsis"],[1,"cursor-pointer"],[3,"item"],["styleClass","px-4",3,"value","rounded"],[1,"flex","justify-content-center","cursor-pointer",3,"click"],[4,"ngIf"],[1,"text-center","white-space-nowrap"],[3,"taskStatus"],[3,"task"],[4,"ngFor","ngForOf"],["tooltipPosition","bottom","shape","circle",3,"pTooltip","label"],["colspan","10",1,"text-center","py-4"]],template:function(e,s){if(1&e){const u=t.EpF();t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),t._uU(5,"\u0ea5\u0eb2\u0e8d\u0e81\u0eb2\u0e99\u0ea7\u0ebd\u0e81\u0e97\u0eb5\u0ec8\u0e97\u0ec8\u0eb2\u0e99\u0eaa\u0ec9\u0eb2\u0e87\u0ea1\u0ead\u0e9a\u0edd\u0eb2\u0e8d\u0ec3\u0eab\u0ec9\u0ec1\u0e81\u0ec8 (\u0eaa\u0eb0\u0ea1\u0eb2\u0e8a\u0eb4\u0e81)"),t.qZA()(),t.TgZ(6,"div",3)(7,"form",5)(8,"app-year-picker",6),t.NdJ("yearSelected",function(m){return s.onSelectedYear(m)}),t.qZA()(),t.TgZ(9,"span",7),t._UZ(10,"i",8),t.TgZ(11,"input",9),t.NdJ("input",function(m){t.CHM(u);const B=t.MAs(15);return t.KtG(s.filter.dataTable(B,m))}),t.qZA()(),t.TgZ(12,"p-button",10),t.NdJ("click",function(){return s.showCreateForm()}),t.qZA()()(),t._UZ(13,"hr"),t.TgZ(14,"p-table",11,12),t.YNc(16,Mt,21,0,"ng-template",13),t.YNc(17,Pt,25,21,"ng-template",14),t.YNc(18,Nt,3,0,"ng-template",15),t.qZA()()()}2&e&&(t.xp6(7),t.Q6J("formGroup",s.formGroup),t.xp6(7),t.Q6J("value",s.tasks)("rows",25)("paginator",!0)("globalFilterFields",s.filterFields)("scrollable",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(8,Gt)))},dependencies:[i.sg,i.O5,i.PC,f._Y,f.JL,f.sg,p.VP,W.iA,I.jx,U.o,H.u,M.zx,Q.V,L.q,q.H,ut.O,at.h,rt.m,St,i.uU],encapsulation:2,changeDetection:0}),n})(),resolve:{data:(()=>{class n{constructor(e){this.taskHelperService=e}resolve(e,s){const u=(new Date).getFullYear();return this.taskHelperService.getTaskOut(u)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(j.P))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()}}];let jt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[A.Bz.forChild(Rt),A.Bz]}),n})();var Wt=o(4466),Ht=o(1989),Lt=o(2137),qt=o(1493),$t=o(5108),zt=o(5121),Kt=o(5047),Vt=o(3054),Xt=o(613),te=o(2453),ee=o(7639),ne=o(1119),ie=o(1889),oe=o(8455),se=o(1480),ue=o(4396),ae=o(3241),re=o(2890),le=o(2448),de=o(4248),pe=o(9981),ce=o(9615),Ee=o(1979),me=o(6749);let fe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[l.E7,l.xA],imports:[i.ez,jt,Wt.m,W.U$,U.j,Kt.L$,Vt.A,te.EV,H.z,$t.x,Lt.D,Q.W,$.o,qt.S,ue.y,w.L,K.l,Xt.cc,oe.$,F._8,Ht.nD,L.F,q.Q,zt.Z_,re.j,se._,ne.H,ie.P,me.g,ae.$,le.q,ee.n,de.W,pe.o,ce.E,Ee.p]}),n})()},8271:(S,Z,o)=>{o.d(Z,{F:()=>g,q:()=>h});var i=o(8274),A=o(6895);function _(r,C){if(1&r&&(i.TgZ(0,"span",4),i._uU(1),i.qZA()),2&r){const t=i.oxw();i.xp6(1),i.Oqu(t.label)}}function D(r,C){if(1&r&&i._UZ(0,"span",6),2&r){const t=i.oxw(2);i.Tol(t.icon),i.Q6J("ngClass","p-avatar-icon")}}function T(r,C){if(1&r&&i.YNc(0,D,1,3,"span",5),2&r){const t=i.oxw(),y=i.MAs(6);i.Q6J("ngIf",t.icon)("ngIfElse",y)}}function E(r,C){if(1&r){const t=i.EpF();i.TgZ(0,"img",8),i.NdJ("error",function(b){i.CHM(t);const v=i.oxw(2);return i.KtG(v.imageError(b))}),i.qZA()}if(2&r){const t=i.oxw(2);i.Q6J("src",t.image,i.LSH)}}function p(r,C){if(1&r&&i.YNc(0,E,1,1,"img",7),2&r){const t=i.oxw();i.Q6J("ngIf",t.image)}}const c=["*"];let h=(()=>{class r{constructor(){this.size="normal",this.shape="square",this.onImageError=new i.vpe}containerClass(){return{"p-avatar p-component":!0,"p-avatar-image":null!=this.image,"p-avatar-circle":"circle"===this.shape,"p-avatar-lg":"large"===this.size,"p-avatar-xl":"xlarge"===this.size}}imageError(t){this.onImageError.emit(t)}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=i.Xpm({type:r,selectors:[["p-avatar"]],hostAttrs:[1,"p-element"],inputs:{label:"label",icon:"icon",image:"image",size:"size",shape:"shape",style:"style",styleClass:"styleClass"},outputs:{onImageError:"onImageError"},ngContentSelectors:c,decls:7,vars:6,consts:[[3,"ngClass","ngStyle"],["class","p-avatar-text",4,"ngIf","ngIfElse"],["iconTemplate",""],["imageTemplate",""],[1,"p-avatar-text"],[3,"class","ngClass",4,"ngIf","ngIfElse"],[3,"ngClass"],[3,"src","error",4,"ngIf"],[3,"src","error"]],template:function(t,y){if(1&t&&(i.F$t(),i.TgZ(0,"div",0),i.Hsn(1),i.YNc(2,_,2,1,"span",1),i.YNc(3,T,1,2,"ng-template",null,2,i.W1O),i.YNc(5,p,1,1,"ng-template",null,3,i.W1O),i.qZA()),2&t){const b=i.MAs(4);i.Tol(y.styleClass),i.Q6J("ngClass",y.containerClass())("ngStyle",y.style),i.xp6(2),i.Q6J("ngIf",y.label)("ngIfElse",b)}},dependencies:[A.mk,A.O5,A.PC],styles:[".p-avatar{display:inline-flex;align-items:center;justify-content:center;width:2rem;height:2rem;font-size:1rem}.p-avatar.p-avatar-image{background-color:transparent}.p-avatar.p-avatar-circle{border-radius:50%;overflow:hidden}.p-avatar .p-avatar-icon{font-size:1rem}.p-avatar img{width:100%;height:100%}\n"],encapsulation:2,changeDetection:0}),r})(),g=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=i.oAB({type:r}),r.\u0275inj=i.cJS({imports:[A.ez]}),r})()},8558:(S,Z,o)=>{o.d(Z,{H:()=>D,Q:()=>T});var i=o(8274),A=o(6895);const _=["*"];let D=(()=>{class E{}return E.\u0275fac=function(c){return new(c||E)},E.\u0275cmp=i.Xpm({type:E,selectors:[["p-avatarGroup"]],hostAttrs:[1,"p-element"],inputs:{styleClass:"styleClass",style:"style"},ngContentSelectors:_,decls:2,vars:4,consts:[[3,"ngClass","ngStyle"]],template:function(c,h){1&c&&(i.F$t(),i.TgZ(0,"div",0),i.Hsn(1),i.qZA()),2&c&&(i.Tol(h.styleClass),i.Q6J("ngClass","p-avatar-group p-component")("ngStyle",h.style))},dependencies:[A.mk,A.PC],styles:[".p-avatar-group p-avatar+p-avatar{margin-left:-1rem}.p-avatar-group{display:flex;align-items:center}\n"],encapsulation:2,changeDetection:0}),E})(),T=(()=>{class E{}return E.\u0275fac=function(c){return new(c||E)},E.\u0275mod=i.oAB({type:E}),E.\u0275inj=i.cJS({imports:[A.ez]}),E})()},3054:(S,Z,o)=>{o.d(Z,{A:()=>T,g:()=>D});var i=o(8274),A=o(6895),_=o(433);let D=(()=>{class E{constructor(c,h,g,r){this.el=c,this.ngModel=h,this.control=g,this.cd=r,this.onResize=new i.vpe}ngOnInit(){this.ngModel&&(this.ngModelSubscription=this.ngModel.valueChanges.subscribe(()=>{this.updateState()})),this.control&&(this.ngControlSubscription=this.control.valueChanges.subscribe(()=>{this.updateState()}))}ngAfterViewInit(){this.autoResize&&this.resize(),this.updateFilledState(),this.cd.detectChanges()}onInput(c){this.updateState()}updateFilledState(){this.filled=this.el.nativeElement.value&&this.el.nativeElement.value.length}onFocus(c){this.autoResize&&this.resize(c)}onBlur(c){this.autoResize&&this.resize(c)}resize(c){this.el.nativeElement.style.height="auto",this.el.nativeElement.style.height=this.el.nativeElement.scrollHeight+"px",parseFloat(this.el.nativeElement.style.height)>=parseFloat(this.el.nativeElement.style.maxHeight)?(this.el.nativeElement.style.overflowY="scroll",this.el.nativeElement.style.height=this.el.nativeElement.style.maxHeight):this.el.nativeElement.style.overflow="hidden",this.onResize.emit(c||{})}updateState(){this.updateFilledState(),this.autoResize&&this.resize()}ngOnDestroy(){this.ngModelSubscription&&this.ngModelSubscription.unsubscribe(),this.ngControlSubscription&&this.ngControlSubscription.unsubscribe()}}return E.\u0275fac=function(c){return new(c||E)(i.Y36(i.SBq),i.Y36(_.On,8),i.Y36(_.a5,8),i.Y36(i.sBO))},E.\u0275dir=i.lG2({type:E,selectors:[["","pInputTextarea",""]],hostAttrs:[1,"p-inputtextarea","p-inputtext","p-component","p-element"],hostVars:4,hostBindings:function(c,h){1&c&&i.NdJ("input",function(r){return h.onInput(r)})("focus",function(r){return h.onFocus(r)})("blur",function(r){return h.onBlur(r)}),2&c&&i.ekj("p-filled",h.filled)("p-inputtextarea-resizable",h.autoResize)},inputs:{autoResize:"autoResize"},outputs:{onResize:"onResize"}}),E})(),T=(()=>{class E{}return E.\u0275fac=function(c){return new(c||E)},E.\u0275mod=i.oAB({type:E}),E.\u0275inj=i.cJS({imports:[A.ez]}),E})()}}]);